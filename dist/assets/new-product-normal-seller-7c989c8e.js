import{ag as ut,af as ht,aa as et,aE as Ot,aw as gt,r as W,ac as pt,j as _,ad as Ze,ae as mt,ap as se,aU as _e,bG as vt,ab as Se,t as he,ar as Pt,aK as bt,T as Ae,c as Lt,ao as zt,bH as Vt,b as tt,bI as Bt,bJ as Wt,f as rt,bK as yt,bL as xt,s as At,bM as wt,bF as Qt}from"./index-335be6bc.js";import{u as $t}from"./index.esm-6c063bf2.js";import{C as Xe,a as Gt,D as qt,b as Ye,u as Kt,T as Zt}from"./use-images-upload-a62aca7d.js";import{L as Xt}from"./Link-6563cda1.js";import{s as Yt}from"./product-normal-seller-calls-a58909a0.js";import{u as Ct}from"./useDispatch-5616ae48.js";import{C as Je}from"./snackbar-ff9e0661.js";import{E as Jt,C as er,A as tr}from"./Edit-72906540.js";import{u as rr,C as nr}from"./category-product-autocomplete-5f17f107.js";import{P as ir}from"./Paper-7bffdec0.js";import{G as Ne}from"./Grid-dac6798f.js";import{T as jt}from"./Tooltip-0185c911.js";import{a as ar,b as or,c as sr}from"./DialogContent-2da759e4.js";import{D as lr}from"./DialogTitle-cffb5590.js";import{T as st}from"./TextField-e3426f14.js";import{L as cr}from"./Link-f99010b1.js";import"./FormControl-0c7a5a9b.js";import"./isMuiElement-28855bcf.js";import"./MenuItem-ae06aebb.js";import"./List-429b0059.js";import"./listItemTextClasses-c15af42f.js";import"./Snackbar-abf2ba22.js";import"./useSlot-06d6b379.js";import"./ClickAwayListener-9b9a333f.js";import"./Grow-32d2c9c3.js";import"./Alert-67637005.js";import"./Close-a8700400.js";import"./categories-55af903f.js";import"./functions-6046b92c.js";import"./moment-fbc5633a.js";import"./Autocomplete-7da48e1d.js";import"./Popper-6a651f11.js";import"./Portal-29f66c29.js";import"./useControlled-35363894.js";function fr(w){return ut("MuiCardActionArea",w)}const dr=ht("MuiCardActionArea",["root","focusVisible","focusHighlight"]),qe=dr,ur=w=>{const{classes:S}=w;return mt({root:["root"],focusHighlight:["focusHighlight"]},fr,S)},hr=et(Ot,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(w,S)=>S.root})(gt(({theme:w})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${qe.focusHighlight}`]:{opacity:(w.vars||w).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${qe.focusVisible} .${qe.focusHighlight}`]:{opacity:(w.vars||w).palette.action.focusOpacity}}))),gr=et("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(w,S)=>S.focusHighlight})(gt(({theme:w})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:w.transitions.create("opacity",{duration:w.transitions.duration.short})}))),pr=W.forwardRef(function(S,I){const c=pt({props:S,name:"MuiCardActionArea"}),{children:e,className:t,focusVisibleClassName:l,...a}=c,g=c,v=ur(g);return _.jsxs(hr,{className:Ze(v.root,t),focusVisibleClassName:Ze(l,v.focusVisible),ref:I,ownerState:g,...a,children:[e,_.jsx(gr,{className:v.focusHighlight,ownerState:g})]})}),mr=pr;function vr(w){return ut("MuiCardMedia",w)}ht("MuiCardMedia",["root","media","img"]);const br=w=>{const{classes:S,isMediaComponent:I,isImageComponent:c}=w;return mt({root:["root",I&&"media",c&&"img"]},vr,S)},yr=et("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(w,S)=>{const{ownerState:I}=w,{isMediaComponent:c,isImageComponent:e}=I;return[S.root,c&&S.media,e&&S.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),xr=["video","audio","picture","iframe","img"],Ar=["picture","img"],wr=W.forwardRef(function(S,I){const c=pt({props:S,name:"MuiCardMedia"}),{children:e,className:t,component:l="div",image:a,src:g,style:v,...n}=c,i=xr.includes(l),r=!i&&a?{backgroundImage:`url("${a}")`,...v}:v,o={...c,component:l,isMediaComponent:i,isImageComponent:Ar.includes(l)},h=br(o);return _.jsx(yr,{className:Ze(h.root,t),as:l,role:!i&&a?"img":void 0,ref:I,style:r,ownerState:o,src:i?a||g:void 0,...n,children:e})}),lt=wr;const Cr=({subProducts:w,setSubProducts:S,data:I,setSelectedSubProduct:c})=>{const e=a=>{S(g=>g.filter((v,n)=>n!==a))},t=a=>/^#[0-9A-F]{6}$/i.test(a),l=a=>{c(a)};return _.jsx("div",{className:"sub-product-cards",children:_.jsx(se,{display:"flex",flexWrap:"wrap",gap:"30px",children:w.map((a,g)=>_.jsxs(Xe,{sx:{height:`${w[w.length-1]*1.8+5}em`,backgroundColor:a.isValid?"#E5FFE5":"#FFD9D9",border:a.isValid?"2px solid var(--color-secondary)":"2px solid red"},className:"card",onClick:()=>{l(a)},children:[_.jsx(_e,{size:"small",onClick:()=>e(g),className:"delete-card",sx:{color:a.isValid?"var(--color-secondary)":"red",border:a.isValid?"2px solid var(--color-secondary)":"2px solid red"},children:_.jsx(vt,{fontSize:"small"})}),_.jsxs(Gt,{className:"sub-product-details",children:[_.jsxs(Se,{className:"card-title",sx:{color:a.isValid?"var(--color-secondary)":"red"},variant:"h6",component:"div",children:[I.name," ",g+1]}),_.jsxs(Se,{className:"card-sub-title",variant:"subtitle1",component:"div",children:[he("details"),":"]}),Object.keys(a.variations).map((v,n)=>_.jsx(Se,{component:"div",children:_.jsxs(se,{className:"detail-pair",sx:{display:"flex",alignItems:"center"},children:[_.jsxs(se,{className:"detail-key",sx:{marginRight:"8px"},children:[v,":"]}),t(a.variations[v])?_.jsx(se,{sx:{backgroundColor:a.variations[v],width:20,height:20,borderRadius:"50%"}}):_.jsx(se,{sx:{color:a.isValid?"var(--color-secondary)":"red"},className:"detail-value",children:_.jsx("strong",{children:a.variations[v]})})]})},n))]})]},a.idTemp))})})},jr=(w,S)=>{const I=Pt(),c=Ct(),{error:e,isFetching:t,succeed:l}=bt(C=>C.productNormalSeller),[a,g]=W.useState(!1),[v,n]=W.useState(!1),i=async()=>{var C;if((C=w==null?void 0:w.subProducts)!=null&&C.length&&w.subProducts.some(x=>x.isValid===!1)){g(!0);return}try{await Yt(w,c),S({name:"",description:"",category:[],url:""}),n(!0)}catch(M){console.log(M)}};W.useEffect(()=>{v&&t===!1&&e===!1&&l===!0&&I(-1)},[v,t,e,l,I]);const[r,o]=W.useState(!1);return W.useEffect(()=>{o(t===!0)},[t,e]),{showError:a,handleSubmitNewProduct:i,handleCloseError:()=>{g(!1)},disableSubmitButton:r}},Sr=(w,S,I)=>{const[c,e]=W.useState({name:"",description:"",category:[],url:""});W.useEffect(()=>{g([]),e(r=>({...r,category:w.map(o=>o.value)}))},[w]),W.useEffect(()=>{e(r=>({...r,images:S}))},[S]);const[t,l]=W.useState([]);W.useEffect(()=>{e(r=>({...r,customVariations:t}))},[t]);const[a,g]=W.useState([]);W.useEffect(()=>{a.length&&e(r=>({...r,subProducts:a})),I([])},[a]);const v=r=>{const o=r.target.id,h=r.target.value;e(C=>({...C,[o]:h}))},[n,i]=W.useState({idTemp:""});return{data:c,setData:e,customVariations:t,setCustomVariations:l,subProducts:a,setSubProducts:g,handleInput:v,selectedSubProduct:n,setSelectedSubProduct:i}};const Ur=({details:w,setSubProducts:S,subProducts:I,images:c,selectedSubProduct:e,setSelectedSubProduct:t,offers:l,setCustomVariations:a,categories:g})=>{const[v,n]=W.useState({}),i=A=>{const b={},j=m=>{if(Array.isArray(m))return m;typeof m=="object"&&m!==null&&Object.entries(m).forEach(([U,u])=>{const s=j(u);s&&(b[U]=s)})};return j(A),b};W.useEffect(()=>{n(i(w))},[w]);const[r,o]=W.useState([{detail:"",value:""}]);W.useEffect(()=>{o([{detail:"",value:""}])},[g]);const h=()=>{o([{detail:"",value:""},...r])},[C,M]=W.useState(!1),x=()=>{M(!0)},T=()=>{M(!1)};W.useEffect(()=>{if(e!=null&&e.idTemp){const A=r.map(b=>({detail:b.detail,value:(e==null?void 0:e.variations[b.detail])||""}));o(A)}},[e==null?void 0:e.idTemp]);const N=(A,b)=>A.some(j=>Object.keys(j.variations).length!==b.length?!1:b.every(m=>j.variations[m.detail]===m.value)),E=()=>{if(!r.every(U=>U.value!=="")){R(!0);return}if(N(I,r)){f(!0);return}const b=r.reduce((U,u)=>({...U,[u.detail]:u.value}),{}),j={idTemp:"id"+Math.random().toString(16).slice(2),variations:b,isValid:!0,...c?{images:c}:{},...l?{offers:l}:{}};S(U=>[...U,j]);const m=r.map(U=>({detail:U.detail,value:""}));o(m)},D=()=>{if(!r.every(m=>m.value!=="")){R(!0);return}if(N(I,r)&&!e.idTemp){f(!0);return}const b=r.reduce((m,U)=>({...m,[U.detail]:U.value}),{});S(m=>[...m.filter(u=>u.idTemp!==e.idTemp),{...e,variations:b,isValid:!0}]),t({idTemp:""});const j=r.map(m=>({detail:m.detail,value:""}));o(j)},[p,R]=W.useState(!1),[d,f]=W.useState(!1),y=()=>{R(!1),f(!1)};return W.useEffect(()=>{C||S(A=>A.map(b=>r.length!==Object.keys(b.variations).length?{...b,isValid:!1}:r.every(m=>b.variations[m.detail])?b:{...b,isValid:!1}))},[C]),_.jsxs("div",{className:"details",children:[_.jsxs("div",{className:"title",children:[he("details"),":",_.jsxs("div",{className:"buttons-container",children:[(I==null?void 0:I.length)>0&&!C&&_.jsx(_e,{sx:{fontWeight:"bold",fontSize:"24px"},color:"primary",type:"button",onClick:x,className:"plus-button",children:_.jsx(Jt,{sx:{fontSize:28}})}),C&&_.jsx(_e,{sx:{fontWeight:"bold",fontSize:"24px"},color:"primary",type:"button",onClick:T,className:"plus-button",children:_.jsx(er,{sx:{fontSize:28}})}),(C||(I==null?void 0:I.length)<1)&&_.jsx(_e,{sx:{fontWeight:"bold",fontSize:"24px"},type:"button",color:"primary",onClick:h,className:"plus-button",children:_.jsx(tr,{sx:{fontSize:32}})})]})]}),_.jsx("div",{className:"detail-pair",children:r.map((A,b)=>_.jsx(qt,{setDropDownDetails:n,dropDownDetails:v,detailPair:A,setCurrentDetails:o,currentDetails:r,index:b,subProducts:I,editVariations:C,setCustomVariations:a}))}),(e==null?void 0:e.idTemp)===""?_.jsx(Ae,{className:"add-sub-product",type:"button",variant:"outlined",color:"primary",fullWidth:!0,disabled:C,sx:{"&.Mui-disabled":{color:"var(--color-gray) !important",borderColor:"var(--color-gray) !important"}},onClick:E,children:he("add")}):_.jsx(Ae,{className:"add-sub-product",type:"button",variant:"outlined",color:"primary",fullWidth:!0,disabled:C,sx:{"&.Mui-disabled":{color:"var(--color-gray) !important",borderColor:"var(--color-gray) !important"}},onClick:D,children:he("save")}),_.jsx(Je,{open:p,message:he("all values must be set before adding a sub-product !"),severity:"warning",autoHideDuration:6e3,onClose:y}),_.jsx(Je,{open:d,message:he("this sub-product already exists !"),severity:"warning",autoHideDuration:6e3,onClose:y})]})},ct=Lt(_.jsx("path",{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8zM5 19l3-4 2 3 3-4 4 5z"}),"AddPhotoAlternate");function Er({images:w,onOpenGallery:S,onDeleteImage:I,maxImages:c=1/0}){const{t:e}=zt();return _.jsxs(se,{className:"enhanced-image-uploader",children:[_.jsxs(se,{className:"uploader-header",children:[_.jsx(Se,{variant:"h6",children:e("Product Images")}),c!==1/0&&_.jsxs(Se,{variant:"body2",color:"text.secondary",children:[w==null?void 0:w.length," / ",c," ",e("images")]})]}),_.jsx(ir,{elevation:0,className:"images-container",children:_.jsxs(Ne,{container:!0,spacing:2,children:[w==null?void 0:w.map((t,l)=>_.jsx(Ne,{item:!0,xs:6,sm:6,md:4,lg:3,children:_.jsxs(se,{className:"image-item",children:[_.jsx("img",{src:t,alt:`Product ${l}`}),_.jsx(jt,{title:e("Remove image"),children:_.jsx(_e,{onClick:()=>I(t),className:"delete-button",size:"small",children:_.jsx(Ye,{})})})]})},`image-${l}`)),(w==null?void 0:w.length)<c&&_.jsx(Ne,{item:!0,xs:6,sm:6,md:4,lg:3,children:_.jsx(Ae,{className:"add-image-button",onClick:S,variant:"outlined",fullWidth:!0,children:_.jsxs(se,{className:"add-button-content",children:[_.jsx(ct,{}),_.jsx(Se,{children:e("Add Images")})]})})}),(w==null?void 0:w.length)===0&&_.jsx(Ne,{item:!0,xs:12,children:_.jsxs(se,{className:"empty-state",children:[_.jsx(ct,{fontSize:"large"}),_.jsx(Se,{variant:"body1",children:e("No images selected")}),_.jsx(Se,{variant:"body2",color:"text.secondary",children:e("Click the button above to add images from gallery")})]})})]})})]})}const Pe=async w=>{w(Vt());try{const S=await tt.get("/storage/get-gallery");w(Bt(S.data.content))}catch(S){w(Wt()),rt(S,w)}},Ir=async(w,S)=>{S(yt());try{const I=await tt.post("/storage/upload-images",w,{headers:{"Content-Type":"multipart/form-data"}});S(xt(I.data)),At(I.data.responseMessage,S)}catch(I){S(wt()),rt(I,S)}},ft=async(w,S)=>{S(yt());try{const I=await tt.put("/storage//move-images-to-trash",w);S(xt(I.data)),At(I.data.responseMessage,S)}catch(I){S(wt()),rt(I,S)}};function Fr(w,S){return S.forEach(function(I){I&&typeof I!="string"&&!Array.isArray(I)&&Object.keys(I).forEach(function(c){if(c!=="default"&&!(c in w)){var e=Object.getOwnPropertyDescriptor(I,c);Object.defineProperty(w,c,e.get?e:{enumerable:!0,get:function(){return I[c]}})}})}),Object.freeze(w)}function St(w,S){return new Promise(function(I,c){let e;return Mr(w).then(function(t){try{return e=t,I(new Blob([S.slice(0,2),e,S.slice(2)],{type:"image/jpeg"}))}catch(l){return c(l)}},c)})}const Mr=w=>new Promise((S,I)=>{const c=new FileReader;c.addEventListener("load",({target:{result:e}})=>{const t=new DataView(e);let l=0;if(t.getUint16(l)!==65496)return I("not a valid JPEG");for(l+=2;;){const a=t.getUint16(l);if(a===65498)break;const g=t.getUint16(l+2);if(a===65505&&t.getUint32(l+4)===1165519206){const v=l+10;let n;switch(t.getUint16(v)){case 18761:n=!0;break;case 19789:n=!1;break;default:return I("TIFF header contains invalid endian")}if(t.getUint16(v+2,n)!==42)return I("TIFF header contains invalid version");const i=t.getUint32(v+4,n),r=v+i+2+12*t.getUint16(v+i,n);for(let o=v+i+2;o<r;o+=12)if(t.getUint16(o,n)==274){if(t.getUint16(o+2,n)!==3)return I("Orientation data type is invalid");if(t.getUint32(o+4,n)!==1)return I("Orientation data count is invalid");t.setUint16(o+8,1,n);break}return S(e.slice(l,l+2+g))}l+=2+g}return S(new Blob)}),c.readAsArrayBuffer(w)});var ze={},Nr={get exports(){return ze},set exports(w){ze=w}};(function(w){var S,I,c={};Nr.exports=c,c.parse=function(e,t){for(var l=c.bin.readUshort,a=c.bin.readUint,g=0,v={},n=new Uint8Array(e),i=n.length-4;a(n,i)!=101010256;)i--;g=i,g+=4;var r=l(n,g+=4);l(n,g+=2);var o=a(n,g+=2),h=a(n,g+=4);g+=4,g=h;for(var C=0;C<r;C++){a(n,g),g+=4,g+=4,g+=4,a(n,g+=4),o=a(n,g+=4);var M=a(n,g+=4),x=l(n,g+=4),T=l(n,g+2),N=l(n,g+4);g+=6;var E=a(n,g+=8);g+=4,g+=x+T+N,c._readLocal(n,E,v,o,M,t)}return v},c._readLocal=function(e,t,l,a,g,v){var n=c.bin.readUshort,i=c.bin.readUint;i(e,t),n(e,t+=4),n(e,t+=2);var r=n(e,t+=2);i(e,t+=2),i(e,t+=4),t+=4;var o=n(e,t+=8),h=n(e,t+=2);t+=2;var C=c.bin.readUTF8(e,t,o);if(t+=o,t+=h,v)l[C]={size:g,csize:a};else{var M=new Uint8Array(e.buffer,t);if(r==0)l[C]=new Uint8Array(M.buffer.slice(t,t+a));else{if(r!=8)throw"unknown compression method: "+r;var x=new Uint8Array(g);c.inflateRaw(M,x),l[C]=x}}},c.inflateRaw=function(e,t){return c.F.inflate(e,t)},c.inflate=function(e,t){return e[0],e[1],c.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},c.deflate=function(e,t){t==null&&(t={level:6});var l=0,a=new Uint8Array(50+Math.floor(1.1*e.length));a[l]=120,a[l+1]=156,l+=2,l=c.F.deflateRaw(e,a,l,t.level);var g=c.adler(e,0,e.length);return a[l+0]=g>>>24&255,a[l+1]=g>>>16&255,a[l+2]=g>>>8&255,a[l+3]=g>>>0&255,new Uint8Array(a.buffer,0,l+4)},c.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),a=c.F.deflateRaw(e,l,a,t.level);return new Uint8Array(l.buffer,0,a)},c.encode=function(e,t){t==null&&(t=!1);var l=0,a=c.bin.writeUint,g=c.bin.writeUshort,v={};for(var n in e){var i=!c._noNeed(n)&&!t,r=e[n],o=c.crc.crc(r,0,r.length);v[n]={cpr:i,usize:r.length,crc:o,file:i?c.deflateRaw(r):r}}for(var n in v)l+=v[n].file.length+30+46+2*c.bin.sizeUTF8(n);l+=22;var h=new Uint8Array(l),C=0,M=[];for(var n in v){var x=v[n];M.push(C),C=c._writeHeader(h,C,n,x,0)}var T=0,N=C;for(var n in v)x=v[n],M.push(C),C=c._writeHeader(h,C,n,x,1,M[T++]);var E=C-N;return a(h,C,101010256),C+=4,g(h,C+=4,T),g(h,C+=2,T),a(h,C+=2,E),a(h,C+=4,N),C+=4,C+=2,h.buffer},c._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},c._writeHeader=function(e,t,l,a,g,v){var n=c.bin.writeUint,i=c.bin.writeUshort,r=a.file;return n(e,t,g==0?67324752:33639248),t+=4,g==1&&(t+=2),i(e,t,20),i(e,t+=2,0),i(e,t+=2,a.cpr?8:0),n(e,t+=2,0),n(e,t+=4,a.crc),n(e,t+=4,r.length),n(e,t+=4,a.usize),i(e,t+=4,c.bin.sizeUTF8(l)),i(e,t+=2,0),t+=2,g==1&&(t+=2,t+=2,n(e,t+=6,v),t+=4),t+=c.bin.writeUTF8(e,t,l),g==0&&(e.set(r,t),t+=r.length),t},c.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,a=0;a<8;a++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e}(),update:function(e,t,l,a){for(var g=0;g<a;g++)e=c.crc.table[255&(e^t[l+g])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^c.crc.update(4294967295,e,t,l)}},c.adler=function(e,t,l){for(var a=1,g=0,v=t,n=t+l;v<n;){for(var i=Math.min(v+5552,n);v<i;)g+=a+=e[v++];a%=65521,g%=65521}return g<<16|a},c.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var a="",g=0;g<l;g++)a+=String.fromCharCode(e[t+g]);return a},writeASCII:function(e,t,l){for(var a=0;a<l.length;a++)e[t+a]=l.charCodeAt(a)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var a,g="",v=0;v<l;v++)g+="%"+c.bin.pad(e[t+v].toString(16));try{a=decodeURIComponent(g)}catch{return c.bin.readASCII(e,t,l)}return a},writeUTF8:function(e,t,l){for(var a=l.length,g=0,v=0;v<a;v++){var n=l.charCodeAt(v);if(!(4294967168&n))e[t+g]=n,g++;else if(!(4294965248&n))e[t+g]=192|n>>6,e[t+g+1]=128|n>>0&63,g+=2;else if(!(4294901760&n))e[t+g]=224|n>>12,e[t+g+1]=128|n>>6&63,e[t+g+2]=128|n>>0&63,g+=3;else{if(4292870144&n)throw"e";e[t+g]=240|n>>18,e[t+g+1]=128|n>>12&63,e[t+g+2]=128|n>>6&63,e[t+g+3]=128|n>>0&63,g+=4}}return g},sizeUTF8:function(e){for(var t=e.length,l=0,a=0;a<t;a++){var g=e.charCodeAt(a);if(!(4294967168&g))l++;else if(!(4294965248&g))l+=2;else if(!(4294901760&g))l+=3;else{if(4292870144&g)throw"e";l+=4}}return l}},c.F={},c.F.deflateRaw=function(e,t,l,a){var g=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],v=c.F.U,n=c.F._goodIndex;c.F._hash;var i=c.F._putsE,r=0,o=l<<3,h=0,C=e.length;if(a==0){for(;r<C;)i(t,o,r+(A=Math.min(65535,C-r))==C?1:0),o=c.F._copyExact(e,r,A,t,o+8),r+=A;return o>>>3}var M=v.lits,x=v.strt,T=v.prev,N=0,E=0,D=0,p=0,R=0,d=0;for(C>2&&(x[d=c.F._hash(e,0)]=0),r=0;r<C;r++){if(R=d,r+1<C-2){d=c.F._hash(e,r+1);var f=r+1&32767;T[f]=x[d],x[d]=f}if(h<=r){(N>14e3||E>26697)&&C-r>100&&(h<r&&(M[N]=r-h,N+=2,h=r),o=c.F._writeBlock(r==C-1||h==C?1:0,M,N,p,e,D,r-D,t,o),N=E=p=0,D=r);var y=0;r<C-2&&(y=c.F._bestMatch(e,r,T,R,Math.min(g[2],C-r),g[3]));var A=y>>>16,b=65535&y;if(y!=0){b=65535&y;var j=n(A=y>>>16,v.of0);v.lhst[257+j]++;var m=n(b,v.df0);v.dhst[m]++,p+=v.exb[j]+v.dxb[m],M[N]=A<<23|r-h,M[N+1]=b<<16|j<<8|m,N+=2,h=r+A}else v.lhst[e[r]]++;E++}}for(D==r&&e.length!=0||(h<r&&(M[N]=r-h,N+=2,h=r),o=c.F._writeBlock(1,M,N,p,e,D,r-D,t,o),N=0,E=0,N=E=p=0,D=r);7&o;)o++;return o>>>3},c.F._bestMatch=function(e,t,l,a,g,v){var n=32767&t,i=l[n],r=n-i+32768&32767;if(i==n||a!=c.F._hash(e,t-r))return 0;for(var o=0,h=0,C=Math.min(32767,t);r<=C&&--v!=0&&i!=n;){if(o==0||e[t+o]==e[t+o-r]){var M=c.F._howLong(e,t,r);if(M>o){if(h=r,(o=M)>=g)break;r+2<M&&(M=r+2);for(var x=0,T=0;T<M-2;T++){var N=t-r+T+32768&32767,E=N-l[N]+32768&32767;E>x&&(x=E,i=N)}}}r+=(n=i)-(i=l[n])+32768&32767}return o<<16|h},c.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var a=t,g=Math.min(e.length,t+258);for(t+=3;t<g&&e[t]==e[t-l];)t++;return t-a},c.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},c.saved=0,c.F._writeBlock=function(e,t,l,a,g,v,n,i,r){var o,h,C,M,x,T,N,E,D,p=c.F.U,R=c.F._putsF,d=c.F._putsE;p.lhst[256]++,h=(o=c.F.getTrees())[0],C=o[1],M=o[2],x=o[3],T=o[4],N=o[5],E=o[6],D=o[7];var f=32+(r+3&7?8-(r+3&7):0)+(n<<3),y=a+c.F.contSize(p.fltree,p.lhst)+c.F.contSize(p.fdtree,p.dhst),A=a+c.F.contSize(p.ltree,p.lhst)+c.F.contSize(p.dtree,p.dhst);A+=14+3*N+c.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var b=0;b<286;b++)p.lhst[b]=0;for(b=0;b<30;b++)p.dhst[b]=0;for(b=0;b<19;b++)p.ihst[b]=0;var j=f<y&&f<A?0:y<A?1:2;if(R(i,r,e),R(i,r+1,j),r+=3,j==0){for(;7&r;)r++;r=c.F._copyExact(g,v,n,i,r)}else{var m,U;if(j==1&&(m=p.fltree,U=p.fdtree),j==2){c.F.makeCodes(p.ltree,h),c.F.revCodes(p.ltree,h),c.F.makeCodes(p.dtree,C),c.F.revCodes(p.dtree,C),c.F.makeCodes(p.itree,M),c.F.revCodes(p.itree,M),m=p.ltree,U=p.dtree,d(i,r,x-257),d(i,r+=5,T-1),d(i,r+=5,N-4),r+=4;for(var u=0;u<N;u++)d(i,r+3*u,p.itree[1+(p.ordr[u]<<1)]);r+=3*N,r=c.F._codeTiny(E,p.itree,i,r),r=c.F._codeTiny(D,p.itree,i,r)}for(var s=v,H=0;H<l;H+=2){for(var F=t[H],O=F>>>23,V=s+(8388607&F);s<V;)r=c.F._writeLit(g[s++],m,i,r);if(O!=0){var L=t[H+1],z=L>>16,P=L>>8&255,k=255&L;d(i,r=c.F._writeLit(257+P,m,i,r),O-p.of0[P]),r+=p.exb[P],R(i,r=c.F._writeLit(k,U,i,r),z-p.df0[k]),r+=p.dxb[k],s+=O}}r=c.F._writeLit(256,m,i,r)}return r},c.F._copyExact=function(e,t,l,a,g){var v=g>>>3;return a[v]=l,a[v+1]=l>>>8,a[v+2]=255-a[v],a[v+3]=255-a[v+1],v+=4,a.set(new Uint8Array(e.buffer,t,l),v),g+(l+4<<3)},c.F.getTrees=function(){for(var e=c.F.U,t=c.F._hufTree(e.lhst,e.ltree,15),l=c.F._hufTree(e.dhst,e.dtree,15),a=[],g=c.F._lenCodes(e.ltree,a),v=[],n=c.F._lenCodes(e.dtree,v),i=0;i<a.length;i+=2)e.ihst[a[i]]++;for(i=0;i<v.length;i+=2)e.ihst[v[i]]++;for(var r=c.F._hufTree(e.ihst,e.itree,7),o=19;o>4&&e.itree[1+(e.ordr[o-1]<<1)]==0;)o--;return[t,l,r,g,n,o,a,v]},c.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},c.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},c.F.contSize=function(e,t){for(var l=0,a=0;a<t.length;a++)l+=t[a]*e[1+(a<<1)];return l},c.F._codeTiny=function(e,t,l,a){for(var g=0;g<e.length;g+=2){var v=e[g],n=e[g+1];a=c.F._writeLit(v,t,l,a);var i=v==16?2:v==17?3:7;v>15&&(c.F._putsE(l,a,n,i),a+=i)}return a},c.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var a=0;a<l;a+=2){var g=e[a+1],v=a+3<l?e[a+3]:-1,n=a+5<l?e[a+5]:-1,i=a==0?-1:e[a-1];if(g==0&&v==g&&n==g){for(var r=a+5;r+2<l&&e[r+2]==g;)r+=2;(o=Math.min(r+1-a>>>1,138))<11?t.push(17,o-3):t.push(18,o-11),a+=2*o-2}else if(g==i&&v==g&&n==g){for(r=a+5;r+2<l&&e[r+2]==g;)r+=2;var o=Math.min(r+1-a>>>1,6);t.push(16,o-3),a+=2*o-2}else t.push(g,0)}return l>>>1},c.F._hufTree=function(e,t,l){var a=[],g=e.length,v=t.length,n=0;for(n=0;n<v;n+=2)t[n]=0,t[n+1]=0;for(n=0;n<g;n++)e[n]!=0&&a.push({lit:n,f:e[n]});var i=a.length,r=a.slice(0);if(i==0)return 0;if(i==1){var o=a[0].lit;return r=o==0?1:0,t[1+(o<<1)]=1,t[1+(r<<1)]=1,1}a.sort(function(E,D){return E.f-D.f});var h=a[0],C=a[1],M=0,x=1,T=2;for(a[0]={lit:-1,f:h.f+C.f,l:h,r:C,d:0};x!=i-1;)h=M!=x&&(T==i||a[M].f<a[T].f)?a[M++]:a[T++],C=M!=x&&(T==i||a[M].f<a[T].f)?a[M++]:a[T++],a[x++]={lit:-1,f:h.f+C.f,l:h,r:C};var N=c.F.setDepth(a[x-1],0);for(N>l&&(c.F.restrictDepth(r,l,N),N=l),n=0;n<i;n++)t[1+(r[n].lit<<1)]=r[n].d;return N},c.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(c.F.setDepth(e.l,t+1),c.F.setDepth(e.r,t+1))},c.F.restrictDepth=function(e,t,l){var a=0,g=1<<l-t,v=0;for(e.sort(function(i,r){return r.d==i.d?i.f-r.f:r.d-i.d}),a=0;a<e.length&&e[a].d>t;a++){var n=e[a].d;e[a].d=t,v+=g-(1<<l-n)}for(v>>>=l-t;v>0;)(n=e[a].d)<t?(e[a].d++,v-=1<<t-n-1):a++;for(;a>=0;a--)e[a].d==t&&v<0&&(e[a].d--,v++);v!=0&&console.log("debt left")},c.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},c.F._writeLit=function(e,t,l,a){return c.F._putsF(l,a,t[e<<1]),a+t[1+(e<<1)]},c.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var a=c.F,g=a._bitsF,v=a._bitsE,n=a._decodeTiny,i=a.makeCodes,r=a.codes2map,o=a._get17,h=a.U,C=t==null;C&&(t=new l(e.length>>>2<<3));for(var M,x,T=0,N=0,E=0,D=0,p=0,R=0,d=0,f=0,y=0;T==0;)if(T=g(e,y,1),N=g(e,y+1,2),y+=3,N!=0){if(C&&(t=c.F._check(t,f+(1<<17))),N==1&&(M=h.flmap,x=h.fdmap,R=511,d=31),N==2){E=v(e,y,5)+257,D=v(e,y+5,5)+1,p=v(e,y+10,4)+4,y+=14;for(var A=0;A<38;A+=2)h.itree[A]=0,h.itree[A+1]=0;var b=1;for(A=0;A<p;A++){var j=v(e,y+3*A,3);h.itree[1+(h.ordr[A]<<1)]=j,j>b&&(b=j)}y+=3*p,i(h.itree,b),r(h.itree,b,h.imap),M=h.lmap,x=h.dmap,y=n(h.imap,(1<<b)-1,E+D,e,y,h.ttree);var m=a._copyOut(h.ttree,0,E,h.ltree);R=(1<<m)-1;var U=a._copyOut(h.ttree,E,D,h.dtree);d=(1<<U)-1,i(h.ltree,m),r(h.ltree,m,M),i(h.dtree,U),r(h.dtree,U,x)}for(;;){var u=M[o(e,y)&R];y+=15&u;var s=u>>>4;if(!(s>>>8))t[f++]=s;else{if(s==256)break;var H=f+s-254;if(s>264){var F=h.ldef[s-257];H=f+(F>>>3)+v(e,y,7&F),y+=7&F}var O=x[o(e,y)&d];y+=15&O;var V=O>>>4,L=h.ddef[V],z=(L>>>4)+g(e,y,15&L);for(y+=15&L,C&&(t=c.F._check(t,f+(1<<17)));f<H;)t[f]=t[f++-z],t[f]=t[f++-z],t[f]=t[f++-z],t[f]=t[f++-z];f=H}}}else{7&y&&(y+=8-(7&y));var P=4+(y>>>3),k=e[P-4]|e[P-3]<<8;C&&(t=c.F._check(t,f+k)),t.set(new l(e.buffer,e.byteOffset+P,k),f),y=P+k<<3,f+=k}return t.length==f?t:t.slice(0,f)},c.F._check=function(e,t){var l=e.length;if(t<=l)return e;var a=new Uint8Array(Math.max(l<<1,t));return a.set(e,0),a},c.F._decodeTiny=function(e,t,l,a,g,v){for(var n=c.F._bitsE,i=c.F._get17,r=0;r<l;){var o=e[i(a,g)&t];g+=15&o;var h=o>>>4;if(h<=15)v[r]=h,r++;else{var C=0,M=0;h==16?(M=3+n(a,g,2),g+=2,C=v[r-1]):h==17?(M=3+n(a,g,3),g+=3):h==18&&(M=11+n(a,g,7),g+=7);for(var x=r+M;r<x;)v[r]=C,r++}}return g},c.F._copyOut=function(e,t,l,a){for(var g=0,v=0,n=a.length>>>1;v<l;){var i=e[v+t];a[v<<1]=0,a[1+(v<<1)]=i,i>g&&(g=i),v++}for(;v<n;)a[v<<1]=0,a[1+(v<<1)]=0,v++;return g},c.F.makeCodes=function(e,t){for(var l,a,g,v,n=c.F.U,i=e.length,r=n.bl_count,o=0;o<=t;o++)r[o]=0;for(o=1;o<i;o+=2)r[e[o]]++;var h=n.next_code;for(l=0,r[0]=0,a=1;a<=t;a++)l=l+r[a-1]<<1,h[a]=l;for(g=0;g<i;g+=2)(v=e[g+1])!=0&&(e[g]=h[v],h[v]++)},c.F.codes2map=function(e,t,l){for(var a=e.length,g=c.F.U.rev15,v=0;v<a;v+=2)if(e[v+1]!=0)for(var n=v>>1,i=e[v+1],r=n<<4|i,o=t-i,h=e[v]<<o,C=h+(1<<o);h!=C;)l[g[h]>>>15-t]=r,h++},c.F.revCodes=function(e,t){for(var l=c.F.U.rev15,a=15-t,g=0;g<e.length;g+=2){var v=e[g]<<t-e[g+1];e[g]=l[v]>>>a}},c.F._putsE=function(e,t,l){l<<=7&t;var a=t>>>3;e[a]|=l,e[a+1]|=l>>>8},c.F._putsF=function(e,t,l){l<<=7&t;var a=t>>>3;e[a]|=l,e[a+1]|=l>>>8,e[a+2]|=l>>>16},c.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},c.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},c.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},c.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},c.F.U=(S=Uint16Array,I=Uint32Array,{next_code:new S(16),bl_count:new S(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new S(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new I(32),flmap:new S(512),fltree:[],fdmap:new S(32),fdtree:[],lmap:new S(32768),ltree:[],ttree:[],dmap:new S(32768),dtree:[],imap:new S(512),itree:[],rev15:new S(32768),lhst:new I(286),dhst:new I(30),ihst:new I(19),lits:new I(15e3),strt:new S(65536),prev:new S(32768)}),function(){for(var e=c.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function a(g,v,n){for(;v--!=0;)g.push(0,n)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];a(e.fltree,144,8),a(e.fltree,112,9),a(e.fltree,24,7),a(e.fltree,8,8),c.F.makeCodes(e.fltree,9),c.F.codes2map(e.fltree,9,e.flmap),c.F.revCodes(e.fltree,9),a(e.fdtree,32,5),c.F.makeCodes(e.fdtree,5),c.F.codes2map(e.fdtree,5,e.fdmap),c.F.revCodes(e.fdtree,5),a(e.itree,19,0),a(e.ltree,286,0),a(e.dtree,30,0),a(e.ttree,320,0)}()})();var Rr=Fr({__proto__:null,default:ze},[ze]);const me=function(){var w={nextZero(n,i){for(;n[i]!=0;)i++;return i},readUshort:(n,i)=>n[i]<<8|n[i+1],writeUshort(n,i,r){n[i]=r>>8&255,n[i+1]=255&r},readUint:(n,i)=>16777216*n[i]+(n[i+1]<<16|n[i+2]<<8|n[i+3]),writeUint(n,i,r){n[i]=r>>24&255,n[i+1]=r>>16&255,n[i+2]=r>>8&255,n[i+3]=255&r},readASCII(n,i,r){let o="";for(let h=0;h<r;h++)o+=String.fromCharCode(n[i+h]);return o},writeASCII(n,i,r){for(let o=0;o<r.length;o++)n[i+o]=r.charCodeAt(o)},readBytes(n,i,r){const o=[];for(let h=0;h<r;h++)o.push(n[i+h]);return o},pad:n=>n.length<2?`0${n}`:n,readUTF8(n,i,r){let o,h="";for(let C=0;C<r;C++)h+=`%${w.pad(n[i+C].toString(16))}`;try{o=decodeURIComponent(h)}catch{return w.readASCII(n,i,r)}return o}};function S(n,i,r,o){const h=i*r,C=t(o),M=Math.ceil(i*C/8),x=new Uint8Array(4*h),T=new Uint32Array(x.buffer),{ctype:N}=o,{depth:E}=o,D=w.readUshort;if(N==6){const F=h<<2;if(E==8)for(var p=0;p<F;p+=4)x[p]=n[p],x[p+1]=n[p+1],x[p+2]=n[p+2],x[p+3]=n[p+3];if(E==16)for(p=0;p<F;p++)x[p]=n[p<<1]}else if(N==2){const F=o.tabs.tRNS;if(F==null){if(E==8)for(p=0;p<h;p++){var R=3*p;T[p]=255<<24|n[R+2]<<16|n[R+1]<<8|n[R]}if(E==16)for(p=0;p<h;p++)R=6*p,T[p]=255<<24|n[R+4]<<16|n[R+2]<<8|n[R]}else{var d=F[0];const O=F[1],V=F[2];if(E==8)for(p=0;p<h;p++){var f=p<<2;R=3*p,T[p]=255<<24|n[R+2]<<16|n[R+1]<<8|n[R],n[R]==d&&n[R+1]==O&&n[R+2]==V&&(x[f+3]=0)}if(E==16)for(p=0;p<h;p++)f=p<<2,R=6*p,T[p]=255<<24|n[R+4]<<16|n[R+2]<<8|n[R],D(n,R)==d&&D(n,R+2)==O&&D(n,R+4)==V&&(x[f+3]=0)}}else if(N==3){const F=o.tabs.PLTE,O=o.tabs.tRNS,V=O?O.length:0;if(E==1)for(var y=0;y<r;y++){var A=y*M,b=y*i;for(p=0;p<i;p++){f=b+p<<2;var j=3*(m=n[A+(p>>3)]>>7-((7&p)<<0)&1);x[f]=F[j],x[f+1]=F[j+1],x[f+2]=F[j+2],x[f+3]=m<V?O[m]:255}}if(E==2)for(y=0;y<r;y++)for(A=y*M,b=y*i,p=0;p<i;p++)f=b+p<<2,j=3*(m=n[A+(p>>2)]>>6-((3&p)<<1)&3),x[f]=F[j],x[f+1]=F[j+1],x[f+2]=F[j+2],x[f+3]=m<V?O[m]:255;if(E==4)for(y=0;y<r;y++)for(A=y*M,b=y*i,p=0;p<i;p++)f=b+p<<2,j=3*(m=n[A+(p>>1)]>>4-((1&p)<<2)&15),x[f]=F[j],x[f+1]=F[j+1],x[f+2]=F[j+2],x[f+3]=m<V?O[m]:255;if(E==8)for(p=0;p<h;p++){var m;f=p<<2,j=3*(m=n[p]),x[f]=F[j],x[f+1]=F[j+1],x[f+2]=F[j+2],x[f+3]=m<V?O[m]:255}}else if(N==4){if(E==8)for(p=0;p<h;p++){f=p<<2;var U=n[u=p<<1];x[f]=U,x[f+1]=U,x[f+2]=U,x[f+3]=n[u+1]}if(E==16)for(p=0;p<h;p++){var u;f=p<<2,U=n[u=p<<2],x[f]=U,x[f+1]=U,x[f+2]=U,x[f+3]=n[u+2]}}else if(N==0)for(d=o.tabs.tRNS?o.tabs.tRNS:-1,y=0;y<r;y++){const F=y*M,O=y*i;if(E==1)for(var s=0;s<i;s++){var H=(U=255*(n[F+(s>>>3)]>>>7-(7&s)&1))==255*d?0:255;T[O+s]=H<<24|U<<16|U<<8|U}else if(E==2)for(s=0;s<i;s++)H=(U=85*(n[F+(s>>>2)]>>>6-((3&s)<<1)&3))==85*d?0:255,T[O+s]=H<<24|U<<16|U<<8|U;else if(E==4)for(s=0;s<i;s++)H=(U=17*(n[F+(s>>>1)]>>>4-((1&s)<<2)&15))==17*d?0:255,T[O+s]=H<<24|U<<16|U<<8|U;else if(E==8)for(s=0;s<i;s++)H=(U=n[F+s])==d?0:255,T[O+s]=H<<24|U<<16|U<<8|U;else if(E==16)for(s=0;s<i;s++)U=n[F+(s<<1)],H=D(n,F+(s<<1))==d?0:255,T[O+s]=H<<24|U<<16|U<<8|U}return x}function I(n,i,r,o){const h=t(n),C=Math.ceil(r*h/8),M=new Uint8Array((C+1+n.interlace)*o);return i=n.tabs.CgBI?e(i,M):c(i,M),n.interlace==0?i=l(i,n,0,r,o):n.interlace==1&&(i=function(T,N){const E=N.width,D=N.height,p=t(N),R=p>>3,d=Math.ceil(E*p/8),f=new Uint8Array(D*d);let y=0;const A=[0,0,4,0,2,0,1],b=[0,4,0,2,0,1,0],j=[8,8,8,4,4,2,2],m=[8,8,4,4,2,2,1];let U=0;for(;U<7;){const s=j[U],H=m[U];let F=0,O=0,V=A[U];for(;V<D;)V+=s,O++;let L=b[U];for(;L<E;)L+=H,F++;const z=Math.ceil(F*p/8);l(T,N,y,F,O);let P=0,k=A[U];for(;k<D;){let B=b[U],Z=y+P*z<<3;for(;B<E;){var u;if(p==1&&(u=(u=T[Z>>3])>>7-(7&Z)&1,f[k*d+(B>>3)]|=u<<7-((7&B)<<0)),p==2&&(u=(u=T[Z>>3])>>6-(7&Z)&3,f[k*d+(B>>2)]|=u<<6-((3&B)<<1)),p==4&&(u=(u=T[Z>>3])>>4-(7&Z)&15,f[k*d+(B>>1)]|=u<<4-((1&B)<<2)),p>=8){const $=k*d+B*R;for(let Q=0;Q<R;Q++)f[$+Q]=T[(Z>>3)+Q]}Z+=p,B+=H}P++,k+=s}F*O!=0&&(y+=O*(1+z)),U+=1}return f}(i,n)),i}function c(n,i){return e(new Uint8Array(n.buffer,2,n.length-6),i)}var e=function(){const n={H:{}};return n.H.N=function(i,r){const o=Uint8Array;let h,C,M=0,x=0,T=0,N=0,E=0,D=0,p=0,R=0,d=0;if(i[0]==3&&i[1]==0)return r||new o(0);const f=n.H,y=f.b,A=f.e,b=f.R,j=f.n,m=f.A,U=f.Z,u=f.m,s=r==null;for(s&&(r=new o(i.length>>>2<<5));M==0;)if(M=y(i,d,1),x=y(i,d+1,2),d+=3,x!=0){if(s&&(r=n.H.W(r,R+(1<<17))),x==1&&(h=u.J,C=u.h,D=511,p=31),x==2){T=A(i,d,5)+257,N=A(i,d+5,5)+1,E=A(i,d+10,4)+4,d+=14;let F=1;for(var H=0;H<38;H+=2)u.Q[H]=0,u.Q[H+1]=0;for(H=0;H<E;H++){const L=A(i,d+3*H,3);u.Q[1+(u.X[H]<<1)]=L,L>F&&(F=L)}d+=3*E,j(u.Q,F),m(u.Q,F,u.u),h=u.w,C=u.d,d=b(u.u,(1<<F)-1,T+N,i,d,u.v);const O=f.V(u.v,0,T,u.C);D=(1<<O)-1;const V=f.V(u.v,T,N,u.D);p=(1<<V)-1,j(u.C,O),m(u.C,O,h),j(u.D,V),m(u.D,V,C)}for(;;){const F=h[U(i,d)&D];d+=15&F;const O=F>>>4;if(!(O>>>8))r[R++]=O;else{if(O==256)break;{let V=R+O-254;if(O>264){const B=u.q[O-257];V=R+(B>>>3)+A(i,d,7&B),d+=7&B}const L=C[U(i,d)&p];d+=15&L;const z=L>>>4,P=u.c[z],k=(P>>>4)+y(i,d,15&P);for(d+=15&P;R<V;)r[R]=r[R++-k],r[R]=r[R++-k],r[R]=r[R++-k],r[R]=r[R++-k];R=V}}}}else{7&d&&(d+=8-(7&d));const F=4+(d>>>3),O=i[F-4]|i[F-3]<<8;s&&(r=n.H.W(r,R+O)),r.set(new o(i.buffer,i.byteOffset+F,O),R),d=F+O<<3,R+=O}return r.length==R?r:r.slice(0,R)},n.H.W=function(i,r){const o=i.length;if(r<=o)return i;const h=new Uint8Array(o<<1);return h.set(i,0),h},n.H.R=function(i,r,o,h,C,M){const x=n.H.e,T=n.H.Z;let N=0;for(;N<o;){const E=i[T(h,C)&r];C+=15&E;const D=E>>>4;if(D<=15)M[N]=D,N++;else{let p=0,R=0;D==16?(R=3+x(h,C,2),C+=2,p=M[N-1]):D==17?(R=3+x(h,C,3),C+=3):D==18&&(R=11+x(h,C,7),C+=7);const d=N+R;for(;N<d;)M[N]=p,N++}}return C},n.H.V=function(i,r,o,h){let C=0,M=0;const x=h.length>>>1;for(;M<o;){const T=i[M+r];h[M<<1]=0,h[1+(M<<1)]=T,T>C&&(C=T),M++}for(;M<x;)h[M<<1]=0,h[1+(M<<1)]=0,M++;return C},n.H.n=function(i,r){const o=n.H.m,h=i.length;let C,M,x,T;const N=o.j;for(var E=0;E<=r;E++)N[E]=0;for(E=1;E<h;E+=2)N[i[E]]++;const D=o.K;for(C=0,N[0]=0,M=1;M<=r;M++)C=C+N[M-1]<<1,D[M]=C;for(x=0;x<h;x+=2)T=i[x+1],T!=0&&(i[x]=D[T],D[T]++)},n.H.A=function(i,r,o){const h=i.length,C=n.H.m.r;for(let M=0;M<h;M+=2)if(i[M+1]!=0){const x=M>>1,T=i[M+1],N=x<<4|T,E=r-T;let D=i[M]<<E;const p=D+(1<<E);for(;D!=p;)o[C[D]>>>15-r]=N,D++}},n.H.l=function(i,r){const o=n.H.m.r,h=15-r;for(let C=0;C<i.length;C+=2){const M=i[C]<<r-i[C+1];i[C]=o[M]>>>h}},n.H.M=function(i,r,o){o<<=7&r;const h=r>>>3;i[h]|=o,i[h+1]|=o>>>8},n.H.I=function(i,r,o){o<<=7&r;const h=r>>>3;i[h]|=o,i[h+1]|=o>>>8,i[h+2]|=o>>>16},n.H.e=function(i,r,o){return(i[r>>>3]|i[1+(r>>>3)]<<8)>>>(7&r)&(1<<o)-1},n.H.b=function(i,r,o){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)&(1<<o)-1},n.H.Z=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)},n.H.i=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16|i[3+(r>>>3)]<<24)>>>(7&r)},n.H.m=function(){const i=Uint16Array,r=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new i(65536),g:new i(32768)}}(),function(){const i=n.H.m;for(var r=0;r<32768;r++){let h=r;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,i.r[r]=(h>>>16|h<<16)>>>17}function o(h,C,M){for(;C--!=0;)h.push(0,M)}for(r=0;r<32;r++)i.q[r]=i.S[r]<<3|i.T[r],i.c[r]=i.p[r]<<4|i.z[r];o(i._,144,8),o(i._,112,9),o(i._,24,7),o(i._,8,8),n.H.n(i._,9),n.H.A(i._,9,i.J),n.H.l(i._,9),o(i.$,32,5),n.H.n(i.$,5),n.H.A(i.$,5,i.h),n.H.l(i.$,5),o(i.Q,19,0),o(i.C,286,0),o(i.D,30,0),o(i.v,320,0)}(),n.H.N}();function t(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth}function l(n,i,r,o,h){let C=t(i);const M=Math.ceil(o*C/8);let x,T;C=Math.ceil(C/8);let N=n[r],E=0;if(N>1&&(n[r]=[0,0,1][N-2]),N==3)for(E=C;E<M;E++)n[E+1]=n[E+1]+(n[E+1-C]>>>1)&255;for(let D=0;D<h;D++)if(x=r+D*M,T=x+D+1,N=n[T-1],E=0,N==0)for(;E<M;E++)n[x+E]=n[T+E];else if(N==1){for(;E<C;E++)n[x+E]=n[T+E];for(;E<M;E++)n[x+E]=n[T+E]+n[x+E-C]}else if(N==2)for(;E<M;E++)n[x+E]=n[T+E]+n[x+E-M];else if(N==3){for(;E<C;E++)n[x+E]=n[T+E]+(n[x+E-M]>>>1);for(;E<M;E++)n[x+E]=n[T+E]+(n[x+E-M]+n[x+E-C]>>>1)}else{for(;E<C;E++)n[x+E]=n[T+E]+a(0,n[x+E-M],0);for(;E<M;E++)n[x+E]=n[T+E]+a(n[x+E-C],n[x+E-M],n[x+E-C-M])}return n}function a(n,i,r){const o=n+i-r,h=o-n,C=o-i,M=o-r;return h*h<=C*C&&h*h<=M*M?n:C*C<=M*M?i:r}function g(n,i,r){r.width=w.readUint(n,i),i+=4,r.height=w.readUint(n,i),i+=4,r.depth=n[i],i++,r.ctype=n[i],i++,r.compress=n[i],i++,r.filter=n[i],i++,r.interlace=n[i],i++}function v(n,i,r,o,h,C,M,x,T){const N=Math.min(i,h),E=Math.min(r,C);let D=0,p=0;for(let U=0;U<E;U++)for(let u=0;u<N;u++)if(M>=0&&x>=0?(D=U*i+u<<2,p=(x+U)*h+M+u<<2):(D=(-x+U)*i-M+u<<2,p=U*h+u<<2),T==0)o[p]=n[D],o[p+1]=n[D+1],o[p+2]=n[D+2],o[p+3]=n[D+3];else if(T==1){var R=n[D+3]*.00392156862745098,d=n[D]*R,f=n[D+1]*R,y=n[D+2]*R,A=o[p+3]*(1/255),b=o[p]*A,j=o[p+1]*A,m=o[p+2]*A;const s=1-R,H=R+A*s,F=H==0?0:1/H;o[p+3]=255*H,o[p+0]=(d+b*s)*F,o[p+1]=(f+j*s)*F,o[p+2]=(y+m*s)*F}else if(T==2)R=n[D+3],d=n[D],f=n[D+1],y=n[D+2],A=o[p+3],b=o[p],j=o[p+1],m=o[p+2],R==A&&d==b&&f==j&&y==m?(o[p]=0,o[p+1]=0,o[p+2]=0,o[p+3]=0):(o[p]=d,o[p+1]=f,o[p+2]=y,o[p+3]=R);else if(T==3){if(R=n[D+3],d=n[D],f=n[D+1],y=n[D+2],A=o[p+3],b=o[p],j=o[p+1],m=o[p+2],R==A&&d==b&&f==j&&y==m)continue;if(R<220&&A>20)return!1}return!0}return{decode:function(i){const r=new Uint8Array(i);let o=8;const h=w,C=h.readUshort,M=h.readUint,x={tabs:{},frames:[]},T=new Uint8Array(r.length);let N,E=0,D=0;const p=[137,80,78,71,13,10,26,10];for(var R=0;R<8;R++)if(r[R]!=p[R])throw"The input is not a PNG file!";for(;o<r.length;){const U=h.readUint(r,o);o+=4;const u=h.readASCII(r,o,4);if(o+=4,u=="IHDR")g(r,o,x);else if(u=="iCCP"){for(var d=o;r[d]!=0;)d++;h.readASCII(r,o,d-o),r[d+1];const s=r.slice(d+2,o+U);let H=null;try{H=c(s)}catch{H=e(s)}x.tabs[u]=H}else if(u=="CgBI")x.tabs[u]=r.slice(o,o+4);else if(u=="IDAT"){for(R=0;R<U;R++)T[E+R]=r[o+R];E+=U}else if(u=="acTL")x.tabs[u]={num_frames:M(r,o),num_plays:M(r,o+4)},N=new Uint8Array(r.length);else if(u=="fcTL"){D!=0&&((m=x.frames[x.frames.length-1]).data=I(x,N.slice(0,D),m.rect.width,m.rect.height),D=0);const s={x:M(r,o+12),y:M(r,o+16),width:M(r,o+4),height:M(r,o+8)};let H=C(r,o+22);H=C(r,o+20)/(H==0?100:H);const F={rect:s,delay:Math.round(1e3*H),dispose:r[o+24],blend:r[o+25]};x.frames.push(F)}else if(u=="fdAT"){for(R=0;R<U-4;R++)N[D+R]=r[o+R+4];D+=U-4}else if(u=="pHYs")x.tabs[u]=[h.readUint(r,o),h.readUint(r,o+4),r[o+8]];else if(u=="cHRM")for(x.tabs[u]=[],R=0;R<8;R++)x.tabs[u].push(h.readUint(r,o+4*R));else if(u=="tEXt"||u=="zTXt"){x.tabs[u]==null&&(x.tabs[u]={});var f=h.nextZero(r,o),y=h.readASCII(r,o,f-o),A=o+U-f-1;if(u=="tEXt")j=h.readASCII(r,f+1,A);else{var b=c(r.slice(f+2,f+2+A));j=h.readUTF8(b,0,b.length)}x.tabs[u][y]=j}else if(u=="iTXt"){x.tabs[u]==null&&(x.tabs[u]={}),f=0,d=o,f=h.nextZero(r,d),y=h.readASCII(r,d,f-d);const s=r[d=f+1];var j;r[d+1],d+=2,f=h.nextZero(r,d),h.readASCII(r,d,f-d),d=f+1,f=h.nextZero(r,d),h.readUTF8(r,d,f-d),A=U-((d=f+1)-o),s==0?j=h.readUTF8(r,d,A):(b=c(r.slice(d,d+A)),j=h.readUTF8(b,0,b.length)),x.tabs[u][y]=j}else if(u=="PLTE")x.tabs[u]=h.readBytes(r,o,U);else if(u=="hIST"){const s=x.tabs.PLTE.length/3;for(x.tabs[u]=[],R=0;R<s;R++)x.tabs[u].push(C(r,o+2*R))}else if(u=="tRNS")x.ctype==3?x.tabs[u]=h.readBytes(r,o,U):x.ctype==0?x.tabs[u]=C(r,o):x.ctype==2&&(x.tabs[u]=[C(r,o),C(r,o+2),C(r,o+4)]);else if(u=="gAMA")x.tabs[u]=h.readUint(r,o)/1e5;else if(u=="sRGB")x.tabs[u]=r[o];else if(u=="bKGD")x.ctype==0||x.ctype==4?x.tabs[u]=[C(r,o)]:x.ctype==2||x.ctype==6?x.tabs[u]=[C(r,o),C(r,o+2),C(r,o+4)]:x.ctype==3&&(x.tabs[u]=r[o]);else if(u=="IEND")break;o+=U,h.readUint(r,o),o+=4}var m;return D!=0&&((m=x.frames[x.frames.length-1]).data=I(x,N.slice(0,D),m.rect.width,m.rect.height)),x.data=I(x,T,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(i){const r=i.width,o=i.height;if(i.tabs.acTL==null)return[S(i.data,r,o,i).buffer];const h=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const C=r*o*4,M=new Uint8Array(C),x=new Uint8Array(C),T=new Uint8Array(C);for(let E=0;E<i.frames.length;E++){const D=i.frames[E],p=D.rect.x,R=D.rect.y,d=D.rect.width,f=D.rect.height,y=S(D.data,d,f,i);if(E!=0)for(var N=0;N<C;N++)T[N]=M[N];if(D.blend==0?v(y,d,f,M,r,o,p,R,0):D.blend==1&&v(y,d,f,M,r,o,p,R,1),h.push(M.buffer.slice(0)),D.dispose!=0){if(D.dispose==1)v(x,d,f,M,r,o,p,R,0);else if(D.dispose==2)for(N=0;N<C;N++)M[N]=T[N]}}return h},_paeth:a,_copyTile:v,_bin:w}}();(function(){const{_copyTile:w}=me,{_bin:S}=me,I=me._paeth;var c={table:function(){const d=new Uint32Array(256);for(let f=0;f<256;f++){let y=f;for(let A=0;A<8;A++)1&y?y=3988292384^y>>>1:y>>>=1;d[f]=y}return d}(),update(d,f,y,A){for(let b=0;b<A;b++)d=c.table[255&(d^f[y+b])]^d>>>8;return d},crc:(d,f,y)=>4294967295^c.update(4294967295,d,f,y)};function e(d,f,y,A){f[y]+=d[0]*A>>4,f[y+1]+=d[1]*A>>4,f[y+2]+=d[2]*A>>4,f[y+3]+=d[3]*A>>4}function t(d){return Math.max(0,Math.min(255,d))}function l(d,f){const y=d[0]-f[0],A=d[1]-f[1],b=d[2]-f[2],j=d[3]-f[3];return y*y+A*A+b*b+j*j}function a(d,f,y,A,b,j,m){m==null&&(m=1);const U=A.length,u=[];for(var s=0;s<U;s++){const k=A[s];u.push([k>>>0&255,k>>>8&255,k>>>16&255,k>>>24&255])}for(s=0;s<U;s++){let k=4294967295;for(var H=0,F=0;F<U;F++){var O=l(u[s],u[F]);F!=s&&O<k&&(k=O,H=F)}}const V=new Uint32Array(b.buffer),L=new Int16Array(f*y*4),z=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(s=0;s<z.length;s++)z[s]=255*((z[s]+.5)/16-.5);for(let k=0;k<y;k++)for(let B=0;B<f;B++){var P;s=4*(k*f+B),m!=2?P=[t(d[s]+L[s]),t(d[s+1]+L[s+1]),t(d[s+2]+L[s+2]),t(d[s+3]+L[s+3])]:(O=z[4*(3&k)+(3&B)],P=[t(d[s]+O),t(d[s+1]+O),t(d[s+2]+O),t(d[s+3]+O)]),H=0;let Z=16777215;for(F=0;F<U;F++){const G=l(P,u[F]);G<Z&&(Z=G,H=F)}const $=u[H],Q=[P[0]-$[0],P[1]-$[1],P[2]-$[2],P[3]-$[3]];m==1&&(B!=f-1&&e(Q,L,s+4,7),k!=y-1&&(B!=0&&e(Q,L,s+4*f-4,3),e(Q,L,s+4*f,5),B!=f-1&&e(Q,L,s+4*f+4,1))),j[s>>2]=H,V[s>>2]=A[H]}}function g(d,f,y,A,b){b==null&&(b={});const{crc:j}=c,m=S.writeUint,U=S.writeUshort,u=S.writeASCII;let s=8;const H=d.frames.length>1;let F,O=!1,V=33+(H?20:0);if(b.sRGB!=null&&(V+=13),b.pHYs!=null&&(V+=21),b.iCCP!=null&&(F=pako.deflate(b.iCCP),V+=21+F.length+4),d.ctype==3){for(var L=d.plte.length,z=0;z<L;z++)d.plte[z]>>>24!=255&&(O=!0);V+=8+3*L+4+(O?8+1*L+4:0)}for(var P=0;P<d.frames.length;P++)H&&(V+=38),V+=($=d.frames[P]).cimg.length+12,P!=0&&(V+=4);V+=12;const k=new Uint8Array(V),B=[137,80,78,71,13,10,26,10];for(z=0;z<8;z++)k[z]=B[z];if(m(k,s,13),s+=4,u(k,s,"IHDR"),s+=4,m(k,s,f),s+=4,m(k,s,y),s+=4,k[s]=d.depth,s++,k[s]=d.ctype,s++,k[s]=0,s++,k[s]=0,s++,k[s]=0,s++,m(k,s,j(k,s-17,17)),s+=4,b.sRGB!=null&&(m(k,s,1),s+=4,u(k,s,"sRGB"),s+=4,k[s]=b.sRGB,s++,m(k,s,j(k,s-5,5)),s+=4),b.iCCP!=null){const Q=13+F.length;m(k,s,Q),s+=4,u(k,s,"iCCP"),s+=4,u(k,s,"ICC profile"),s+=11,s+=2,k.set(F,s),s+=F.length,m(k,s,j(k,s-(Q+4),Q+4)),s+=4}if(b.pHYs!=null&&(m(k,s,9),s+=4,u(k,s,"pHYs"),s+=4,m(k,s,b.pHYs[0]),s+=4,m(k,s,b.pHYs[1]),s+=4,k[s]=b.pHYs[2],s++,m(k,s,j(k,s-13,13)),s+=4),H&&(m(k,s,8),s+=4,u(k,s,"acTL"),s+=4,m(k,s,d.frames.length),s+=4,m(k,s,b.loop!=null?b.loop:0),s+=4,m(k,s,j(k,s-12,12)),s+=4),d.ctype==3){for(m(k,s,3*(L=d.plte.length)),s+=4,u(k,s,"PLTE"),s+=4,z=0;z<L;z++){const Q=3*z,G=d.plte[z],J=255&G,re=G>>>8&255,Ue=G>>>16&255;k[s+Q+0]=J,k[s+Q+1]=re,k[s+Q+2]=Ue}if(s+=3*L,m(k,s,j(k,s-3*L-4,3*L+4)),s+=4,O){for(m(k,s,L),s+=4,u(k,s,"tRNS"),s+=4,z=0;z<L;z++)k[s+z]=d.plte[z]>>>24&255;s+=L,m(k,s,j(k,s-L-4,L+4)),s+=4}}let Z=0;for(P=0;P<d.frames.length;P++){var $=d.frames[P];H&&(m(k,s,26),s+=4,u(k,s,"fcTL"),s+=4,m(k,s,Z++),s+=4,m(k,s,$.rect.width),s+=4,m(k,s,$.rect.height),s+=4,m(k,s,$.rect.x),s+=4,m(k,s,$.rect.y),s+=4,U(k,s,A[P]),s+=2,U(k,s,1e3),s+=2,k[s]=$.dispose,s++,k[s]=$.blend,s++,m(k,s,j(k,s-30,30)),s+=4);const Q=$.cimg;m(k,s,(L=Q.length)+(P==0?0:4)),s+=4;const G=s;u(k,s,P==0?"IDAT":"fdAT"),s+=4,P!=0&&(m(k,s,Z++),s+=4),k.set(Q,s),s+=L,m(k,s,j(k,G,s-G)),s+=4}return m(k,s,0),s+=4,u(k,s,"IEND"),s+=4,m(k,s,j(k,s-4,4)),s+=4,k.buffer}function v(d,f,y){for(let A=0;A<d.frames.length;A++){const b=d.frames[A];b.rect.width;const j=b.rect.height,m=new Uint8Array(j*b.bpl+j);b.cimg=o(b.img,j,b.bpp,b.bpl,m,f,y)}}function n(d,f,y,A,b){const j=b[0],m=b[1],U=b[2],u=b[3],s=b[4],H=b[5];let F=6,O=8,V=255;for(var L=0;L<d.length;L++){const ie=new Uint8Array(d[L]);for(var z=ie.length,P=0;P<z;P+=4)V&=ie[P+3]}const k=V!=255,B=function(X,q,ne,le,ee,de){const te=[];for(var K=0;K<X.length;K++){const ce=new Uint8Array(X[K]),pe=new Uint32Array(ce.buffer);var ue;let ge=0,xe=0,be=q,Ie=ne,$e=le?1:0;if(K!=0){const Dt=de||le||K==1||te[K-2].dispose!=0?1:2;let Ge=0,at=1e9;for(let De=0;De<Dt;De++){var we=new Uint8Array(X[K-1-De]);const Ht=new Uint32Array(X[K-1-De]);let Ce=q,je=ne,Te=-1,He=-1;for(let Fe=0;Fe<ne;Fe++)for(let Me=0;Me<q;Me++)pe[ae=Fe*q+Me]!=Ht[ae]&&(Me<Ce&&(Ce=Me),Me>Te&&(Te=Me),Fe<je&&(je=Fe),Fe>He&&(He=Fe));Te==-1&&(Ce=je=Te=He=0),ee&&((1&Ce)==1&&Ce--,(1&je)==1&&je--);const ot=(Te-Ce+1)*(He-je+1);ot<at&&(at=ot,Ge=De,ge=Ce,xe=je,be=Te-Ce+1,Ie=He-je+1)}we=new Uint8Array(X[K-1-Ge]),Ge==1&&(te[K-1].dispose=2),ue=new Uint8Array(be*Ie*4),w(we,q,ne,ue,be,Ie,-ge,-xe,0),$e=w(ce,q,ne,ue,be,Ie,-ge,-xe,3)?1:0,$e==1?r(ce,q,ne,ue,{x:ge,y:xe,width:be,height:Ie}):w(ce,q,ne,ue,be,Ie,-ge,-xe,0)}else ue=ce.slice(0);te.push({rect:{x:ge,y:xe,width:be,height:Ie},img:ue,blend:$e,dispose:0})}if(le)for(K=0;K<te.length;K++){if((Ee=te[K]).blend==1)continue;const ce=Ee.rect,pe=te[K-1].rect,ge=Math.min(ce.x,pe.x),xe=Math.min(ce.y,pe.y),be={x:ge,y:xe,width:Math.max(ce.x+ce.width,pe.x+pe.width)-ge,height:Math.max(ce.y+ce.height,pe.y+pe.height)-xe};te[K-1].dispose=1,K-1!=0&&i(X,q,ne,te,K-1,be,ee),i(X,q,ne,te,K,be,ee)}let Oe=0;if(X.length!=1)for(var ae=0;ae<te.length;ae++){var Ee;Oe+=(Ee=te[ae]).rect.width*Ee.rect.height}return te}(d,f,y,j,m,U),Z={},$=[],Q=[];if(A!=0){const ie=[];for(P=0;P<B.length;P++)ie.push(B[P].img.buffer);const X=function(ee){let de=0;for(var te=0;te<ee.length;te++)de+=ee[te].byteLength;const K=new Uint8Array(de);let ue=0;for(te=0;te<ee.length;te++){const we=new Uint8Array(ee[te]),Oe=we.length;for(let ae=0;ae<Oe;ae+=4){let Ee=we[ae],ce=we[ae+1],pe=we[ae+2];const ge=we[ae+3];ge==0&&(Ee=ce=pe=0),K[ue+ae]=Ee,K[ue+ae+1]=ce,K[ue+ae+2]=pe,K[ue+ae+3]=ge}ue+=Oe}return K.buffer}(ie),q=C(X,A);for(P=0;P<q.plte.length;P++)$.push(q.plte[P].est.rgba);let ne=0;for(P=0;P<B.length;P++){const le=(J=B[P]).img.length;var G=new Uint8Array(q.inds.buffer,ne>>2,le>>2);Q.push(G);const ee=new Uint8Array(q.abuf,ne,le);H&&a(J.img,J.rect.width,J.rect.height,$,ee,G),J.img.set(ee),ne+=le}}else for(L=0;L<B.length;L++){var J=B[L];const ie=new Uint32Array(J.img.buffer);var re=J.rect.width;for(z=ie.length,G=new Uint8Array(z),Q.push(G),P=0;P<z;P++){const X=ie[P];if(P!=0&&X==ie[P-1])G[P]=G[P-1];else if(P>re&&X==ie[P-re])G[P]=G[P-re];else{let q=Z[X];if(q==null&&(Z[X]=q=$.length,$.push(X),$.length>=300))break;G[P]=q}}}const Ue=$.length;for(Ue<=256&&s==0&&(O=Ue<=2?1:Ue<=4?2:Ue<=16?4:8,O=Math.max(O,u)),L=0;L<B.length;L++){(J=B[L]).rect.x,J.rect.y,re=J.rect.width;const ie=J.rect.height;let X=J.img;new Uint32Array(X.buffer);let q=4*re,ne=4;if(Ue<=256&&s==0){q=Math.ceil(O*re/8);var ve=new Uint8Array(q*ie);const le=Q[L];for(let ee=0;ee<ie;ee++){P=ee*q;const de=ee*re;if(O==8)for(var Y=0;Y<re;Y++)ve[P+Y]=le[de+Y];else if(O==4)for(Y=0;Y<re;Y++)ve[P+(Y>>1)]|=le[de+Y]<<4-4*(1&Y);else if(O==2)for(Y=0;Y<re;Y++)ve[P+(Y>>2)]|=le[de+Y]<<6-2*(3&Y);else if(O==1)for(Y=0;Y<re;Y++)ve[P+(Y>>3)]|=le[de+Y]<<7-1*(7&Y)}X=ve,F=3,ne=1}else if(k==0&&B.length==1){ve=new Uint8Array(re*ie*3);const le=re*ie;for(P=0;P<le;P++){const ee=3*P,de=4*P;ve[ee]=X[de],ve[ee+1]=X[de+1],ve[ee+2]=X[de+2]}X=ve,F=2,ne=3,q=3*re}J.img=X,J.bpl=q,J.bpp=ne}return{ctype:F,depth:O,plte:$,frames:B}}function i(d,f,y,A,b,j,m){const U=Uint8Array,u=Uint32Array,s=new U(d[b-1]),H=new u(d[b-1]),F=b+1<d.length?new U(d[b+1]):null,O=new U(d[b]),V=new u(O.buffer);let L=f,z=y,P=-1,k=-1;for(let Z=0;Z<j.height;Z++)for(let $=0;$<j.width;$++){const Q=j.x+$,G=j.y+Z,J=G*f+Q,re=V[J];re==0||A[b-1].dispose==0&&H[J]==re&&(F==null||F[4*J+3]!=0)||(Q<L&&(L=Q),Q>P&&(P=Q),G<z&&(z=G),G>k&&(k=G))}P==-1&&(L=z=P=k=0),m&&((1&L)==1&&L--,(1&z)==1&&z--),j={x:L,y:z,width:P-L+1,height:k-z+1};const B=A[b];B.rect=j,B.blend=1,B.img=new Uint8Array(j.width*j.height*4),A[b-1].dispose==0?(w(s,f,y,B.img,j.width,j.height,-j.x,-j.y,0),r(O,f,y,B.img,j)):w(O,f,y,B.img,j.width,j.height,-j.x,-j.y,0)}function r(d,f,y,A,b){w(d,f,y,A,b.width,b.height,-b.x,-b.y,2)}function o(d,f,y,A,b,j,m){const U=[];let u,s=[0,1,2,3,4];j!=-1?s=[j]:(f*A>5e5||y==1)&&(s=[0]),m&&(u={level:0});const H=Rr;for(var F=0;F<s.length;F++){for(let L=0;L<f;L++)h(b,d,L,A,y,s[F]);U.push(H.deflate(b,u))}let O,V=1e9;for(F=0;F<U.length;F++)U[F].length<V&&(O=F,V=U[F].length);return U[O]}function h(d,f,y,A,b,j){const m=y*A;let U=m+y;if(d[U]=j,U++,j==0)if(A<500)for(var u=0;u<A;u++)d[U+u]=f[m+u];else d.set(new Uint8Array(f.buffer,m,A),U);else if(j==1){for(u=0;u<b;u++)d[U+u]=f[m+u];for(u=b;u<A;u++)d[U+u]=f[m+u]-f[m+u-b]+256&255}else if(y==0){for(u=0;u<b;u++)d[U+u]=f[m+u];if(j==2)for(u=b;u<A;u++)d[U+u]=f[m+u];if(j==3)for(u=b;u<A;u++)d[U+u]=f[m+u]-(f[m+u-b]>>1)+256&255;if(j==4)for(u=b;u<A;u++)d[U+u]=f[m+u]-I(f[m+u-b],0,0)+256&255}else{if(j==2)for(u=0;u<A;u++)d[U+u]=f[m+u]+256-f[m+u-A]&255;if(j==3){for(u=0;u<b;u++)d[U+u]=f[m+u]+256-(f[m+u-A]>>1)&255;for(u=b;u<A;u++)d[U+u]=f[m+u]+256-(f[m+u-A]+f[m+u-b]>>1)&255}if(j==4){for(u=0;u<b;u++)d[U+u]=f[m+u]+256-I(0,f[m+u-A],0)&255;for(u=b;u<A;u++)d[U+u]=f[m+u]+256-I(f[m+u-b],f[m+u-A],f[m+u-b-A])&255}}}function C(d,f){const y=new Uint8Array(d),A=y.slice(0),b=new Uint32Array(A.buffer),j=M(A,f),m=j[0],U=j[1],u=y.length,s=new Uint8Array(u>>2);let H;if(y.length<2e7)for(var F=0;F<u;F+=4)H=x(m,O=y[F]*(1/255),V=y[F+1]*(1/255),L=y[F+2]*(1/255),z=y[F+3]*(1/255)),s[F>>2]=H.ind,b[F>>2]=H.est.rgba;else for(F=0;F<u;F+=4){var O=y[F]*.00392156862745098,V=y[F+1]*(1/255),L=y[F+2]*(1/255),z=y[F+3]*(1/255);for(H=m;H.left;)H=T(H.est,O,V,L,z)<=0?H.left:H.right;s[F>>2]=H.ind,b[F>>2]=H.est.rgba}return{abuf:A.buffer,inds:s,plte:U}}function M(d,f,y){y==null&&(y=1e-4);const A=new Uint32Array(d.buffer),b={i0:0,i1:d.length,bst:null,est:null,tdst:0,left:null,right:null};b.bst=D(d,b.i0,b.i1),b.est=p(b.bst);const j=[b];for(;j.length<f;){let U=0,u=0;for(var m=0;m<j.length;m++)j[m].est.L>U&&(U=j[m].est.L,u=m);if(U<y)break;const s=j[u],H=N(d,A,s.i0,s.i1,s.est.e,s.est.eMq255);if(s.i0>=H||s.i1<=H){s.est.L=0;continue}const F={i0:s.i0,i1:H,bst:null,est:null,tdst:0,left:null,right:null};F.bst=D(d,F.i0,F.i1),F.est=p(F.bst);const O={i0:H,i1:s.i1,bst:null,est:null,tdst:0,left:null,right:null};for(O.bst={R:[],m:[],N:s.bst.N-F.bst.N},m=0;m<16;m++)O.bst.R[m]=s.bst.R[m]-F.bst.R[m];for(m=0;m<4;m++)O.bst.m[m]=s.bst.m[m]-F.bst.m[m];O.est=p(O.bst),s.left=F,s.right=O,j[u]=F,j.push(O)}for(j.sort((U,u)=>u.bst.N-U.bst.N),m=0;m<j.length;m++)j[m].ind=m;return[b,j]}function x(d,f,y,A,b){if(d.left==null)return d.tdst=function(F,O,V,L,z){const P=O-F[0],k=V-F[1],B=L-F[2],Z=z-F[3];return P*P+k*k+B*B+Z*Z}(d.est.q,f,y,A,b),d;const j=T(d.est,f,y,A,b);let m=d.left,U=d.right;j>0&&(m=d.right,U=d.left);const u=x(m,f,y,A,b);if(u.tdst<=j*j)return u;const s=x(U,f,y,A,b);return s.tdst<u.tdst?s:u}function T(d,f,y,A,b){const{e:j}=d;return j[0]*f+j[1]*y+j[2]*A+j[3]*b-d.eMq}function N(d,f,y,A,b,j){for(A-=4;y<A;){for(;E(d,y,b)<=j;)y+=4;for(;E(d,A,b)>j;)A-=4;if(y>=A)break;const m=f[y>>2];f[y>>2]=f[A>>2],f[A>>2]=m,y+=4,A-=4}for(;E(d,y,b)>j;)y-=4;return y+4}function E(d,f,y){return d[f]*y[0]+d[f+1]*y[1]+d[f+2]*y[2]+d[f+3]*y[3]}function D(d,f,y){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=[0,0,0,0],j=y-f>>2;for(let m=f;m<y;m+=4){const U=d[m]*.00392156862745098,u=d[m+1]*(1/255),s=d[m+2]*(1/255),H=d[m+3]*(1/255);b[0]+=U,b[1]+=u,b[2]+=s,b[3]+=H,A[0]+=U*U,A[1]+=U*u,A[2]+=U*s,A[3]+=U*H,A[5]+=u*u,A[6]+=u*s,A[7]+=u*H,A[10]+=s*s,A[11]+=s*H,A[15]+=H*H}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:b,N:j}}function p(d){const{R:f}=d,{m:y}=d,{N:A}=d,b=y[0],j=y[1],m=y[2],U=y[3],u=A==0?0:1/A,s=[f[0]-b*b*u,f[1]-b*j*u,f[2]-b*m*u,f[3]-b*U*u,f[4]-j*b*u,f[5]-j*j*u,f[6]-j*m*u,f[7]-j*U*u,f[8]-m*b*u,f[9]-m*j*u,f[10]-m*m*u,f[11]-m*U*u,f[12]-U*b*u,f[13]-U*j*u,f[14]-U*m*u,f[15]-U*U*u],H=s,F=R;let O=[Math.random(),Math.random(),Math.random(),Math.random()],V=0,L=0;if(A!=0)for(let P=0;P<16&&(O=F.multVec(H,O),L=Math.sqrt(F.dot(O,O)),O=F.sml(1/L,O),!(P!=0&&Math.abs(L-V)<1e-9));P++)V=L;const z=[b*u,j*u,m*u,U*u];return{Cov:s,q:z,e:O,L:V,eMq255:F.dot(F.sml(255,z),O),eMq:F.dot(O,z),rgba:(Math.round(255*z[3])<<24|Math.round(255*z[2])<<16|Math.round(255*z[1])<<8|Math.round(255*z[0])<<0)>>>0}}var R={multVec:(d,f)=>[d[0]*f[0]+d[1]*f[1]+d[2]*f[2]+d[3]*f[3],d[4]*f[0]+d[5]*f[1]+d[6]*f[2]+d[7]*f[3],d[8]*f[0]+d[9]*f[1]+d[10]*f[2]+d[11]*f[3],d[12]*f[0]+d[13]*f[1]+d[14]*f[2]+d[15]*f[3]],dot:(d,f)=>d[0]*f[0]+d[1]*f[1]+d[2]*f[2]+d[3]*f[3],sml:(d,f)=>[d*f[0],d*f[1],d*f[2],d*f[3]]};me.encode=function(f,y,A,b,j,m,U){b==null&&(b=0),U==null&&(U=!1);const u=n(f,y,A,b,[!1,!1,!1,0,U,!1]);return v(u,-1),g(u,y,A,j,m)},me.encodeLL=function(f,y,A,b,j,m,U,u){const s={ctype:0+(b==1?0:2)+(j==0?0:4),depth:m,frames:[]},H=(b+j)*m,F=H*y;for(let O=0;O<f.length;O++)s.frames.push({rect:{x:0,y:0,width:y,height:A},img:new Uint8Array(f[O]),blend:0,dispose:1,bpp:Math.ceil(H/8),bpl:Math.ceil(F/8)});return v(s,0,!0),g(s,y,A,U,u)},me.encode.compress=n,me.encode.dither=a,me.quantize=C,me.quantize.getKDtree=M,me.quantize.getNearest=x})();const Ut={toArrayBuffer(w,S){const I=w.width,c=w.height,e=I<<2,t=w.getContext("2d").getImageData(0,0,I,c),l=new Uint32Array(t.data.buffer),a=(32*I+31)/32<<2,g=a*c,v=122+g,n=new ArrayBuffer(v),i=new DataView(n),r=1<<20;let o,h,C,M,x=r,T=0,N=0,E=0;function D(d){i.setUint16(N,d,!0),N+=2}function p(d){i.setUint32(N,d,!0),N+=4}function R(d){N+=d}D(19778),p(v),R(4),p(122),p(108),p(I),p(-c>>>0),D(1),D(32),p(3),p(g),p(2835),p(2835),R(8),p(16711680),p(65280),p(255),p(4278190080),p(1466527264),function d(){for(;T<c&&x>0;){for(M=122+T*a,o=0;o<e;)x--,h=l[E++],C=h>>>24,i.setUint32(M+o,h<<8|C),o+=4;T++}E<l.length?(x=r,setTimeout(d,Ut._dly)):S(n)}()},toBlob(w,S){this.toArrayBuffer(w,I=>{S(new Blob([I],{type:"image/bmp"}))})},_dly:9};var fe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},_r={[fe.CHROME]:16384,[fe.FIREFOX]:11180,[fe.DESKTOP_SAFARI]:16384,[fe.IE]:8192,[fe.IOS]:4096,[fe.ETC]:8192};const nt=typeof window<"u",Et=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Ve=nt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),Tr=(nt||Et)&&(Ve&&Ve.getOriginalSymbol(window,"File")||typeof File<"u"&&File),It=(nt||Et)&&(Ve&&Ve.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function it(w,S,I=Date.now()){return new Promise(c=>{const e=w.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]);let a=l.length;const g=new Uint8Array(a);for(;a--;)g[a]=l.charCodeAt(a);const v=new Blob([g],{type:t});v.name=S,v.lastModified=I,c(v)})}function Ft(w){return new Promise((S,I)=>{const c=new It;c.onload=()=>S(c.result),c.onerror=e=>I(e),c.readAsDataURL(w)})}function Mt(w){return new Promise((S,I)=>{const c=new Image;c.onload=()=>S(c),c.onerror=e=>I(e),c.src=w})}function Re(){if(Re.cachedResult!==void 0)return Re.cachedResult;let w=fe.ETC;const{userAgent:S}=navigator;return/Chrom(e|ium)/i.test(S)?w=fe.CHROME:/iP(ad|od|hone)/i.test(S)&&/WebKit/i.test(S)?w=fe.IOS:/Safari/i.test(S)?w=fe.DESKTOP_SAFARI:/Firefox/i.test(S)?w=fe.FIREFOX:(/MSIE/i.test(S)||document.documentMode)&&(w=fe.IE),Re.cachedResult=w,Re.cachedResult}function Nt(w,S){const I=Re(),c=_r[I];let e=w,t=S,l=e*t;const a=e>t?t/e:e/t;for(;l>c*c;){const g=(c+e)/2,v=(c+t)/2;g<v?(t=v,e=v*a):(t=g*a,e=g),l=e*t}return{width:e,height:t}}function Qe(w,S){let I,c;try{if(I=new OffscreenCanvas(w,S),c=I.getContext("2d"),c===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{I=document.createElement("canvas"),c=I.getContext("2d")}return I.width=w,I.height=S,[I,c]}function Rt(w,S){const{width:I,height:c}=Nt(w.width,w.height),[e,t]=Qe(I,c);return S&&/jpe?g/.test(S)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(w,0,0,e.width,e.height),e}function Le(){return Le.cachedResult!==void 0||(Le.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Le.cachedResult}function Be(w,S={}){return new Promise(function(I,c){let e,t;var l=function(){try{return t=Rt(e,S.fileType||w.type),I([e,t])}catch(g){return c(g)}},a=function(g){try{var v=function(n){try{throw n}catch(i){return c(i)}};try{let n;return Ft(w).then(function(i){try{return n=i,Mt(n).then(function(r){try{return e=r,function(){try{return l()}catch(o){return c(o)}}()}catch(o){return v(o)}},v)}catch(r){return v(r)}},v)}catch(n){v(n)}}catch(n){return c(n)}};try{if(Le()||[fe.DESKTOP_SAFARI,fe.MOBILE_SAFARI].includes(Re()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(w).then(function(g){try{return e=g,l()}catch{return a()}},a)}catch{a()}})}function We(w,S,I,c,e=1){return new Promise(function(t,l){let a;if(S==="image/png"){let v,n,i;return v=w.getContext("2d"),{data:n}=v.getImageData(0,0,w.width,w.height),i=me.encode([n.buffer],w.width,w.height,4096*e),a=new Blob([i],{type:S}),a.name=I,a.lastModified=c,g.call(this)}{let v=function(){return g.call(this)};if(S==="image/bmp")return new Promise(n=>Ut.toBlob(w,n)).then((function(n){try{return a=n,a.name=I,a.lastModified=c,v.call(this)}catch(i){return l(i)}}).bind(this),l);{let n=function(){return v.call(this)};if(typeof OffscreenCanvas=="function"&&w instanceof OffscreenCanvas)return w.convertToBlob({type:S,quality:e}).then((function(i){try{return a=i,a.name=I,a.lastModified=c,n.call(this)}catch(r){return l(r)}}).bind(this),l);{let i;return i=w.toDataURL(S,e),it(i,I,c).then((function(r){try{return a=r,n.call(this)}catch(o){return l(o)}}).bind(this),l)}}}function g(){return t(a)}})}function ye(w){w.width=0,w.height=0}function ke(){return new Promise(function(w,S){let I,c,e,t;return ke.cachedResult!==void 0?w(ke.cachedResult):it("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(l){try{return I=l,Be(I).then(function(a){try{return c=a[1],We(c,I.type,I.name,I.lastModified).then(function(g){try{return e=g,ye(c),Be(e).then(function(v){try{return t=v[0],ke.cachedResult=t.width===1&&t.height===2,w(ke.cachedResult)}catch(n){return S(n)}},S)}catch(v){return S(v)}},S)}catch(g){return S(g)}},S)}catch(a){return S(a)}},S)})}function _t(w){return new Promise((S,I)=>{const c=new It;c.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return S(-2);const l=t.byteLength;let a=2;for(;a<l;){if(t.getUint16(a+2,!1)<=8)return S(-1);const g=t.getUint16(a,!1);if(a+=2,g==65505){if(t.getUint32(a+=2,!1)!=1165519206)return S(-1);const v=t.getUint16(a+=6,!1)==18761;a+=t.getUint32(a+4,v);const n=t.getUint16(a,v);a+=2;for(let i=0;i<n;i++)if(t.getUint16(a+12*i,v)==274)return S(t.getUint16(a+12*i+8,v))}else{if((65280&g)!=65280)break;a+=t.getUint16(a,!1)}}return S(-1)},c.onerror=e=>I(e),c.readAsArrayBuffer(w)})}function Tt(w,S){const{width:I}=w,{height:c}=w,{maxWidthOrHeight:e}=S;let t,l=w;return isFinite(e)&&(I>e||c>e)&&([l,t]=Qe(I,c),I>c?(l.width=e,l.height=c/I*e):(l.width=I/c*e,l.height=e),t.drawImage(w,0,0,l.width,l.height),ye(w)),l}function kt(w,S){const{width:I}=w,{height:c}=w,[e,t]=Qe(I,c);switch(S>4&&S<9?(e.width=c,e.height=I):(e.width=I,e.height=c),S){case 2:t.transform(-1,0,0,1,I,0);break;case 3:t.transform(-1,0,0,-1,I,c);break;case 4:t.transform(1,0,0,-1,0,c);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,c,0);break;case 7:t.transform(0,-1,-1,0,c,I);break;case 8:t.transform(0,-1,1,0,0,I)}return t.drawImage(w,0,0,I,c),ye(w),e}function dt(w,S,I=0){return new Promise(function(c,e){let t,l,a,g,v,n,i,r,o,h,C,M,x,T,N,E,D,p,R,d;function f(A=5){if(S.signal&&S.signal.aborted)throw S.signal.reason;t+=A,S.onProgress(Math.min(t,100))}function y(A){if(S.signal&&S.signal.aborted)throw S.signal.reason;t=Math.min(Math.max(A,t),100),S.onProgress(t)}return t=I,l=S.maxIteration||10,a=1024*S.maxSizeMB*1024,f(),Be(w,S).then((function(A){try{return[,g]=A,f(),v=Tt(g,S),f(),new Promise(function(b,j){var m;if(!(m=S.exifOrientation))return _t(w).then((function(u){try{return m=u,U.call(this)}catch(s){return j(s)}}).bind(this),j);function U(){return b(m)}return U.call(this)}).then((function(b){try{return n=b,f(),ke().then((function(j){try{return i=j?v:kt(v,n),f(),r=S.initialQuality||1,o=S.fileType||w.type,We(i,o,w.name,w.lastModified,r).then((function(m){try{{let u=function(){if(l--&&(N>a||N>x)){let H,F;return H=d?.95*R.width:R.width,F=d?.95*R.height:R.height,[D,p]=Qe(H,F),p.drawImage(R,0,0,H,F),r*=o==="image/png"?.85:.95,We(D,o,w.name,w.lastModified,r).then(function(O){try{return E=O,ye(R),R=D,N=E.size,y(Math.min(99,Math.floor((T-N)/(T-a)*100))),u}catch(V){return e(V)}},e)}return[1]},s=function(){return ye(R),ye(D),ye(v),ye(i),ye(g),y(100),c(E)};if(h=m,f(),C=h.size>a,M=h.size>w.size,!C&&!M)return y(100),c(h);var U;return x=w.size,T=h.size,N=T,R=i,d=!S.alwaysKeepResolution&&C,(U=(function(H){for(;H;){if(H.then)return void H.then(U,e);try{if(H.pop){if(H.length)return H.pop()?s.call(this):H;H=u}else H=H.call(this)}catch(F){return e(F)}}}).bind(this))(u)}}catch(u){return e(u)}}).bind(this),e)}catch(m){return e(m)}}).bind(this),e)}catch(j){return e(j)}}).bind(this),e)}catch(b){return e(b)}}).bind(this),e)})}const kr=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Ke;function Dr(w,S){return new Promise((I,c)=>{Ke||(Ke=function(l){const a=[];return typeof l=="function"?a.push(`(${l})()`):a.push(l),URL.createObjectURL(new Blob(a))}(kr));const e=new Worker(Ke);e.addEventListener("message",function(l){if(S.signal&&S.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return c(new Error(l.data.error)),void e.terminate();I(l.data.file),e.terminate()}else S.onProgress(l.data.progress)}),e.addEventListener("error",c),S.signal&&S.signal.addEventListener("abort",()=>{c(S.signal.reason),e.terminate()}),e.postMessage({file:w,imageCompressionLibUrl:S.libURL,options:{...S,onProgress:void 0,signal:void 0}})})}function oe(w,S){return new Promise(function(I,c){let e,t,l,a,g,v;if(e={...S},l=0,{onProgress:a}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,g=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=o=>{l=o,typeof a=="function"&&a(l)},!(w instanceof Blob||w instanceof Tr))return c(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(w.type))return c(new Error("The file given is not an image"));if(v=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!g||typeof Worker!="function"||v)return dt(w,e).then((function(o){try{return t=o,r.call(this)}catch(h){return c(h)}}).bind(this),c);var n=(function(){try{return r.call(this)}catch(o){return c(o)}}).bind(this),i=function(o){try{return dt(w,e).then(function(h){try{return t=h,n()}catch(C){return c(C)}},c)}catch(h){return c(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Dr(w,e).then(function(o){try{return t=o,n()}catch{return i()}},i)}catch{i()}function r(){try{t.name=w.name,t.lastModified=w.lastModified}catch{}try{e.preserveExif&&w.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===w.type)&&(t=St(w,t))}catch{}return I(t)}})}oe.getDataUrlFromFile=Ft,oe.getFilefromDataUrl=it,oe.loadImage=Mt,oe.drawImageInCanvas=Rt,oe.drawFileInCanvas=Be,oe.canvasToFile=We,oe.getExifOrientation=_t,oe.handleMaxWidthOrHeight=Tt,oe.followExifOrientation=kt,oe.cleanupCanvasMemory=ye,oe.isAutoOrientationInBrowser=ke,oe.approximateBelowMaximumCanvasSizeOfBrowser=Nt,oe.copyExifWithoutOrientation=St,oe.getBrowserName=Re,oe.version="2.0.2";function Hr({open:w,onClose:S,onSave:I,images:c,limitSelection:e=1/0}){const t=Ct(),l=async T=>{const N=T.target.files;if(!N||N.length===0)return;const E=Array.from(N),D=E.map(R=>URL.createObjectURL(R));o(D);const p=new FormData;for(let R=0;R<E.length;R++){const d=E[R],y=await oe(d,{maxWidthOrHeight:800,useWebWorker:!0,fileType:"image/jpeg"});p.append("images",y)}await Ir(p,t),await Pe(t),T.target.value=null,D.forEach(R=>URL.revokeObjectURL(R)),o([])},a=bt(T=>T.storage.files),[g,v]=W.useState([]);W.useEffect(()=>{v(c)},[c]),W.useEffect(()=>{Pe(t)},[t]);const n=T=>{v(N=>N.includes(T)?N.filter(E=>E!==T):N.length<e?[...N,T]:N)},i=()=>{I(g),S(),v([])},[r,o]=W.useState([]),[h,C]=W.useState(!1),M=async T=>{C(!0),await ft({imagesUrls:[T]},t),v(E=>E.filter(D=>D!==T)),await Pe(t),C(!1)},x=async()=>{if(g.length!==0)try{C(!0),await ft({imagesUrls:g},t),v([]),await Pe(t)}catch(T){console.error("Bulk delete failed:",T)}finally{C(!1)}};return _.jsxs(ar,{onClose:S,open:w,fullWidth:!0,maxWidth:"md",PaperProps:{sx:{height:"85vh",display:"flex",flexDirection:"column",maxHeight:"90vh"}},children:[_.jsx(lr,{className:"dialog-title",sx:{m:0,p:2},id:"customized-dialog-title",children:"Media Gallery"}),_.jsx(_e,{"aria-label":"close",onClick:S,sx:T=>({position:"absolute",right:8,top:8,color:T.palette.grey[500]}),children:_.jsx(vt,{})}),_.jsxs(or,{sx:{p:2},dividers:!0,children:[_.jsxs("div",{className:"uploadArea",children:[_.jsx("input",{type:"file",multiple:!0,onChange:l,accept:".jpg,.jpeg,.png"}),_.jsxs("h4",{children:["drag & drop or ",_.jsx("span",{children:"choose file"})," to upload"]}),_.jsx("h5",{children:"PNG or JPG, JPEG"})]}),_.jsx(se,{mt:5,children:_.jsxs(Ne,{container:!0,spacing:4,children:[r.map((T,N)=>_.jsx(Ne,{item:!0,xs:6,sm:4,md:3,children:_.jsxs(Xe,{sx:{p:0,position:"relative",overflow:"hidden"},children:[_.jsx(se,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:2},children:_.jsx(se,{sx:{width:"60%",height:"4px",backgroundColor:"#e0e0e0",borderRadius:"4px",overflow:"hidden"},children:_.jsx(se,{sx:{width:"30%",height:"100%",backgroundColor:"#1976d2",animation:"loading 1.5s infinite","@keyframes loading":{"0%":{transform:"translateX(-100%)"},"100%":{transform:"translateX(400%)"}}}})})}),_.jsx(lt,{component:"img",height:"160",sx:{borderRadius:"10px",filter:"blur(2px)"},image:T,alt:`uploading-${N}`})]})},`uploading-${N}`)),a.map((T,N)=>{const E=g.includes(T);return _.jsx(Ne,{item:!0,xs:6,sm:4,md:3,children:_.jsxs(Xe,{sx:{border:E?"2px solid #1976d2":"2px solid transparent",borderRadius:"10px",transition:"border 0.3s",p:0,backgroundColor:E?"#D0D0D0":"#ffffff","&:hover":{backgroundColor:"#F0F0F0"},position:"relative"},children:[_.jsx(mr,{onClick:()=>n(T),children:_.jsx(lt,{component:"img",height:"160",image:T,alt:`history-${N}`})}),_.jsx(jt,{title:"Delete image",children:_.jsx(_e,{size:"small",onClick:D=>{D.stopPropagation(),M(T)},sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(255,255,255,0.7)","&:hover":{backgroundColor:"rgba(255,0,0,0.1)"}},children:_.jsx(Ye,{fontSize:"small"})})})]})},N)})]})})]}),_.jsxs(sr,{sx:{width:"100%",position:"relative",justifyContent:"flex-end",px:3},children:[_.jsxs(Ae,{onClick:x,color:"error",sx:{position:"absolute",left:"2%",fontWeight:500},disabled:g.length===0||h,startIcon:h?_.jsx(Qt,{size:20}):_.jsx(Ye,{}),children:["Delete Selected (",g.length,")"]}),_.jsxs(se,{sx:{position:"absolute",left:"50%",transform:"translateX(-50%)",fontWeight:500},children:["Selected: ",g.length,e!==1/0?` / ${e}`:""]}),_.jsxs(se,{display:"flex",gap:2,children:[_.jsx(Ae,{onClick:S,children:"Cancel"}),_.jsx(Ae,{onClick:i,variant:"contained",children:"Save"})]})]})]})}const yn=()=>{const{register:w,handleSubmit:S,formState:{errors:I}}=$t(),[c,e]=W.useState(!1),[t,l]=W.useState(!1),{images:a,setImages:g,handleDelete:v}=Kt(),{choosenCategories:n,categoriesList:i,categoryDetails:r,handleCategoriesChange:o}=rr(),{data:h,setData:C,setCustomVariations:M,subProducts:x,setSubProducts:T,handleInput:N,selectedSubProduct:E,setSelectedSubProduct:D}=Sr(n,a,g),{showError:p,handleSubmitNewProduct:R,handleCloseError:d,disableSubmitButton:f}=jr(h,C);return _.jsx("div",{className:"newProductNormalSeller capitalize",children:_.jsx("div",{className:"newContainer overflowPreventerFlexbox",children:_.jsxs("div",{className:"overflowPreventerContainer",children:[_.jsxs("div",{className:"overflowPreventer",children:[_.jsx("h1",{className:"page-title",children:he("new product")}),_.jsxs("form",{className:"top",onSubmit:S(R),children:[_.jsxs("div",{className:"general-infos",children:[_.jsxs("div",{className:"inputs",children:[_.jsxs("div",{className:"infos-left",children:[_.jsx("div",{className:"formInput",children:_.jsx(st,{...w("name",{required:"name is required",minLength:{value:2,message:"name must be at least 2 characters"}}),fullWidth:!0,id:"name",label:he("product name"),variant:"outlined",onChange:N})}),(I==null?void 0:I.name)&&_.jsx("p",{className:"errorValidation",children:I.name.message}),_.jsxs("div",{className:"formInput url",children:[_.jsx(st,{...w("url",{required:"URL is required",pattern:{value:/^(https?:\/\/)?((([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,})|localhost)(:[0-9]{1,5})?(\/[^\s]*)?(\?[^\s]*)?(#[^\s]*)?$/,message:"Invalid URL format"}}),fullWidth:!0,id:"url",label:he("product provider url"),variant:"outlined",onChange:N}),_.jsx(Ae,{component:cr,type:"button",rel:"noopener",target:"_blank",href:`${h.url}`,disabled:!h.url,children:_.jsx(Xt,{})})]}),(I==null?void 0:I.url)&&_.jsx("p",{className:"errorValidation",children:I.url.message}),_.jsx("div",{className:"formInput",children:_.jsx(nr,{choosenCategories:n,categoriesList:i,handleCategoriesChange:o})}),(I==null?void 0:I.category)&&_.jsx("p",{className:"errorValidation",children:I.category.message})]}),_.jsx("div",{className:"infos-right",children:_.jsx(Zt,{data:h,setData:C})})]}),_.jsx("div",{className:"submit-button",children:_.jsx(Ae,{className:"primary-button",type:"submit",variant:"outlined",disabled:f,children:_.jsxs("span",{className:"capitalize",children:[" ",he("save")]})})})]}),_.jsxs("div",{className:"sub-product-handle",children:[_.jsxs("div",{className:"product-details",children:[_.jsxs("div",{className:"product-details-left",children:[_.jsx(Er,{images:a,onOpenGallery:y=>{y.preventDefault(),l(!0)},onDeleteImage:v}),_.jsx(Hr,{open:t,images:a,onSave:y=>{g(y)},onClose:()=>{l(!1)}})]}),c&&_.jsx("div",{className:"product-details-right",children:_.jsx(Ur,{categories:n,details:r,images:a,setSubProducts:T,subProducts:x,selectedSubProduct:E,setSelectedSubProduct:D,setCustomVariations:M,offers:void 0})})]}),!c&&_.jsx(Ae,{type:"button",variant:"outlined",className:"add-subProduct-button secondary-button",style:{margin:"0 10px"},onClick:()=>{e(!0)},children:_.jsxs("span",{className:"capitalize",children:[he("add")," ",he("sub-product")]})})]})]}),(x==null?void 0:x.length)>0&&_.jsx(Cr,{setSelectedSubProduct:D,subProducts:x,setSubProducts:T,data:h})]}),_.jsx(Je,{open:p,message:he("all sub-products must have the same variations"),severity:"warning",autoHideDuration:6e3,onClose:d})]})})})};export{yn as default};
