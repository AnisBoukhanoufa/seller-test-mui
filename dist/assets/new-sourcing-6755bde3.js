import{ag as S,af as w,aa as N,aw as oe,r as l,ac as R,j as e,ad as M,ae as k,aC as z,t as T,T as re,E as le,ar as ge,u as ye,ao as je,aK as Ce,ah as O,bA as Te,b as Se}from"./index-335be6bc.js";import{s as we}from"./sourcing-calls-1548c967.js";import{u as Ne}from"./index.esm-6c063bf2.js";import{c as K}from"./country-list-72540a93.js";import{S as Re}from"./sub-products-autocomplete-87ffbeaf.js";import{P as Me}from"./Paper-7bffdec0.js";import{T as ke,a as U,b as C}from"./TableCell-077dec01.js";import{i as qe}from"./functions-6046b92c.js";import{A as ne}from"./Autocomplete-7da48e1d.js";import{T as $,I as X,S as G}from"./TextField-e3426f14.js";import{a as J}from"./FormControl-0c7a5a9b.js";import{M as Q}from"./MenuItem-ae06aebb.js";import{C as $e}from"./Checkbox-863386b3.js";import{u as Ie}from"./useDispatch-5616ae48.js";import"./moment-fbc5633a.js";import"./Close-a8700400.js";import"./useSlot-06d6b379.js";import"./Popper-6a651f11.js";import"./Grow-32d2c9c3.js";import"./Portal-29f66c29.js";import"./useControlled-35363894.js";import"./List-429b0059.js";import"./isMuiElement-28855bcf.js";import"./listItemTextClasses-c15af42f.js";import"./SwitchBase-6ca860c4.js";function He(t){return S("MuiTable",t)}w("MuiTable",["root","stickyHeader"]);const Ee=t=>{const{classes:s,stickyHeader:o}=t;return k({root:["root",o&&"stickyHeader"]},He,s)},_e=N("table",{name:"MuiTable",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,o.stickyHeader&&s.stickyHeader]}})(oe(({theme:t})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...t.typography.body2,padding:t.spacing(2),color:(t.vars||t).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:s})=>s.stickyHeader,style:{borderCollapse:"separate"}}]}))),Y="table",Oe=l.forwardRef(function(s,o){const d=R({props:s,name:"MuiTable"}),{className:m,component:n=Y,padding:u="normal",size:r="medium",stickyHeader:h=!1,...g}=d,x={...d,component:n,padding:u,size:r,stickyHeader:h},b=Ee(x),f=l.useMemo(()=>({padding:u,size:r,stickyHeader:h}),[u,r,h]);return e.jsx(ke.Provider,{value:f,children:e.jsx(_e,{as:n,role:n===Y?null:"table",ref:o,className:M(b.root,m),ownerState:x,...g})})}),Ue=Oe;function Ae(t){return S("MuiTableBody",t)}w("MuiTableBody",["root"]);const Be=t=>{const{classes:s}=t;return k({root:["root"]},Ae,s)},Pe=N("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(t,s)=>s.root})({display:"table-row-group"}),De={variant:"body"},Z="tbody",Fe=l.forwardRef(function(s,o){const d=R({props:s,name:"MuiTableBody"}),{className:m,component:n=Z,...u}=d,r={...d,component:n},h=Be(r);return e.jsx(U.Provider,{value:De,children:e.jsx(Pe,{className:M(h.root,m),as:n,ref:o,role:n===Z?null:"rowgroup",ownerState:r,...u})})}),Le=Fe;function Ve(t){return S("MuiTableContainer",t)}w("MuiTableContainer",["root"]);const We=t=>{const{classes:s}=t;return k({root:["root"]},Ve,s)},ze=N("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,s)=>s.root})({width:"100%",overflowX:"auto"}),Ke=l.forwardRef(function(s,o){const d=R({props:s,name:"MuiTableContainer"}),{className:m,component:n="div",...u}=d,r={...d,component:n},h=We(r);return e.jsx(ze,{ref:o,as:n,className:M(h.root,m),ownerState:r,...u})}),Xe=Ke;function Ge(t){return S("MuiTableHead",t)}w("MuiTableHead",["root"]);const Je=t=>{const{classes:s}=t;return k({root:["root"]},Ge,s)},Qe=N("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(t,s)=>s.root})({display:"table-header-group"}),Ye={variant:"head"},ee="thead",Ze=l.forwardRef(function(s,o){const d=R({props:s,name:"MuiTableHead"}),{className:m,component:n=ee,...u}=d,r={...d,component:n},h=Je(r);return e.jsx(U.Provider,{value:Ye,children:e.jsx(Qe,{as:n,className:M(h.root,m),ref:o,role:n===ee?null:"rowgroup",ownerState:r,...u})})}),et=Ze;function tt(t){return S("MuiTableRow",t)}const st=w("MuiTableRow",["root","selected","hover","head","footer"]),te=st,at=t=>{const{classes:s,selected:o,hover:d,head:m,footer:n}=t;return k({root:["root",o&&"selected",d&&"hover",m&&"head",n&&"footer"]},tt,s)},ot=N("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,o.head&&s.head,o.footer&&s.footer]}})(oe(({theme:t})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${te.hover}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${te.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:z(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:z(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)}}}))),se="tr",rt=l.forwardRef(function(s,o){const d=R({props:s,name:"MuiTableRow"}),{className:m,component:n=se,hover:u=!1,selected:r=!1,...h}=d,g=l.useContext(U),x={...d,component:n,hover:u,selected:r,head:g&&g.variant==="head",footer:g&&g.variant==="footer"},b=at(x);return e.jsx(ot,{as:n,ref:o,className:M(b.root,m),role:n===se?null:"row",ownerState:x,...h})}),ae=rt;const lt=({subProducts:t,setSubProducts:s})=>e.jsx("div",{className:"bottom cards",children:e.jsx(Xe,{component:Me,children:e.jsxs(Ue,{children:[e.jsx(et,{children:e.jsxs(ae,{children:[e.jsx(C,{sx:{flex:1},children:T("product")}),e.jsx(C,{sx:{flex:1},children:T("sub-product")}),e.jsx(C,{sx:{flex:1},children:T("quantity")}),e.jsx(C,{sx:{width:150},children:T("action")})]})}),e.jsx(Le,{children:t.map((o,d)=>{var m;return e.jsxs(ae,{children:[e.jsx(C,{className:"table-product cell",children:e.jsx("div",{className:"cell-content",children:o.productName||"Product"})}),e.jsx(C,{children:e.jsxs(e.Fragment,{children:[!o.variations&&o.productName,o.variations&&Object.entries(o.variations).filter(([n])=>n!=="color").map(([n,u],r)=>e.jsxs("span",{children:[u," "]},r)),((m=o.variations)==null?void 0:m.color)&&/^#([0-9A-F]{3}){1,2}$/i.test(o.variations.color)&&e.jsx("span",{style:{display:"inline-block",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:o.variations.color,marginLeft:"5px"}})]})}),e.jsx(C,{children:o.quantity}),e.jsx(C,{children:e.jsx(re,{variant:"contained",color:"success",onClick:()=>{const n=t.filter((u,r)=>r!==d);s(n)},children:"Remove"})})]},d)})})]})})}),nt=({products:t,setProducts:s,choosenProduct:o,setChoosenProduct:d,sellerType:m,width:n=350})=>{const[u,r]=l.useState(null),h=b=>{const f=b.target.value;let i="";m===le.seller?i=`/product-seller/name-pagination?search=${f}&sourcing=1`:i=`/product-affiliate/name-pagination?search=${f}&sourcing=1`,qe(i,s,u,r)},g=(b,f)=>l.createElement("li",{...b,key:f._id},f.name),x=(b,f)=>{d(f||{_id:"",name:""})};return e.jsx(ne,{sx:{width:n},onInput:h,options:t,getOptionLabel:b=>(b==null?void 0:b.name)||"",value:o,onChange:x,renderOption:g,renderInput:b=>e.jsx($,{...b,label:T("products"),placeholder:"Products"})})},Ht=()=>{var V,W;const{register:t,formState:{errors:s},handleSubmit:o}=Ne(),d=Ie(),m=ge(),u=ye().search.split("withCod=")[1],[r,h]=l.useState({}),[g,x]=l.useState([]),[b,f]=l.useState([]),[i,ie]=l.useState({_id:""}),[y,I]=l.useState({_id:null}),[v,H]=l.useState({}),[j,A]=l.useState([]),{t:p}=je(),[E,ce]=l.useState(!1),{isFetching:q,error:_,succeed:B}=Ce(a=>a.sourcing);l.useMemo(()=>[{value:"CN",label:"China"},...K().getData().filter(a=>a.value!=="CN"&&a.value!=="IL")],[]);const P=l.useMemo(()=>[{value:"CN",label:"China"},...K().getData().filter(a=>a.value!=="CN"&&a.value!=="IL")],[]),de=l.useCallback(()=>Object.values(O).map(c=>c===O.KSA?{value:c,label:p("Saudi Arabia")}:c===O.UAE?{value:c,label:p("United Arab Emirates")}:{value:c,label:p(c)}),[]),ue=l.useMemo(()=>de(),[]);l.useEffect(()=>{try{i!=null&&i._id&&(f(i==null?void 0:i.products),i!=null&&i.products[0]&&I(i==null?void 0:i.products[0]))}catch(a){console.log(a)}},[i==null?void 0:i._id]),l.useEffect(()=>{H(null)},[(V=i==null?void 0:i._id)==null?void 0:V._id,y==null?void 0:y._id]),l.useEffect(()=>{(async()=>{try{const c=await Se.get(`/product-seller/name-pagination?pageSize=10&sellerId=${r==null?void 0:r.sellerId}&sourcing=1`);x(c.data.list)}catch{x([])}})()},[]);const pe=a=>{ce(!E)},me=async a=>{const c=a.target.id,xe=a.target.value;H({...v,[c]:xe})},[D,he]=l.useState(!1),F=async a=>{if(a)try{await we({...a,withCod:u==="true",search:E},d),he(!0)}catch(c){console.log(c)}};l.useEffect(()=>{D&&q===!1&&_===!1&&B===!0&&m(-1)},[D,q,_,B]);const be=async a=>{j.length===0?F({...r,products:[{productId:y._id,...v}]}):F({...r,products:j})},fe=async a=>{var c;A([...j,{productName:(c=i==null?void 0:i._id)==null?void 0:c.name,productId:y._id,variations:y.variations,...v}]),I({_id:null}),H(null)},[ve,L]=l.useState(!1);return l.useEffect(()=>{L(q===!0)},[q,_]),e.jsx("div",{className:"newSourcing",children:e.jsx("div",{className:"newContainer overflowPreventerFlexbox",children:e.jsx("div",{className:"overflowPreventerContainer",children:e.jsxs("div",{className:"overflowPreventer",children:[e.jsx("div",{className:"top",children:e.jsx("h1",{className:"title",children:p("new sourcing")})}),e.jsx("div",{className:"bottom",children:e.jsxs("form",{onSubmit:o(be),children:[e.jsxs("div",{className:"sourcing-form-container",children:[e.jsxs("div",{className:"right",children:[e.jsxs("div",{className:"formInput",children:[e.jsxs(J,{fullWidth:!0,children:[e.jsx(X,{id:"demo-simple-select-label",children:p("from")}),e.jsx(G,{...t("from",{required:"This field is required"}),options:P,labelId:"demo-simple-select-label",id:"demo-simple-select",value:r.sourceCountry||"",label:p("from"),onChange:(a,c)=>{h({...r,sourceCountry:a.target.value}),console.log(a.target)},children:P.map(a=>e.jsx(Q,{value:a.label,children:a.label},a.value))})]}),s.from&&e.jsx("p",{className:"errorValidation",children:"This field is required"})]}),e.jsxs("div",{className:"formInput",children:[e.jsxs(J,{fullWidth:!0,children:[e.jsx(X,{id:"demo-simple-select-label",children:p("to")}),e.jsx(G,{...t("to",{required:"This field is required"}),value:r.destinationCountry||"",label:p("to"),onChange:(a,c)=>{h({...r,destinationCountry:a.target.value})},children:ue.map(a=>e.jsx(Q,{value:a.value,children:a.label}))})]}),s.to&&e.jsx("p",{className:"errorValidation",children:"This field is required"})]})]}),e.jsxs("div",{className:"left",style:{justifyContent:u?"initial":"space-between"},children:[e.jsxs("div",{className:"formInput",children:[e.jsx(ne,{disablePortal:!0,loading:!0,options:Object.values(Te),getOptionLabel:a=>p(a),renderOption:(a,c)=>l.createElement("li",{...a,key:c},p(c)),onChange:(a,c)=>{h({...r,shippingMethod:c})},renderInput:a=>e.jsx($,{...a,label:p("shipping method"),variant:"outlined",...t("shippingMethod",{required:"This field is required"})})}),s.shippingMethod&&e.jsx("p",{className:"errorValidation",children:"This field is required"})]}),u==="true"&&e.jsx("div",{className:"formInput check-box",children:e.jsxs("div",{className:"checkbox",children:[e.jsx($e,{name:"searchCheckPurchase",checked:E,onChange:pe,inputProps:{"aria-label":"controlled"}}),e.jsxs("span",{children:[p("search")," - ",p("check")," - ",p("purchase")]})]})})," "]}),e.jsxs("div",{className:"right product-detail",children:[e.jsxs("div",{className:"formInput",children:[e.jsx(nt,{products:g,setProducts:x,choosenProduct:i,setChoosenProduct:ie,sellerType:le.seller,width:"100%"}),s.products&&e.jsx("p",{className:"errorValidation",children:"This field is required"})]}),i._id!==""&&e.jsxs("div",{className:"formInput",children:[e.jsx(Re,{choosenProduct:i,choosenSubProduct:y,subProducts:b,setChoosenSubProduct:I,width:"100%"}),s.products&&e.jsx("p",{className:"errorValidation",children:"This field is required"})]}),e.jsxs("div",{className:"formInput",children:[e.jsx($,{...j.length>0?{}:t("quantity",{required:j.length===0?"This field is required":!1,validate:a=>a>49||"minimum quantity is 50"}),fullWidth:!0,id:"quantity",label:p("quantity"),variant:"outlined",onChange:me,value:(v==null?void 0:v.quantity)||"",type:"number"}),(v==null?void 0:v.quantity)<50&&e.jsx("p",{className:"errorValidation",children:p("minimum quantity 50")}),!(j.length>0)&&s.quantity&&e.jsx("p",{className:"errorValidation",children:(W=s==null?void 0:s.quantity)==null?void 0:W.message})]}),e.jsx("button",{type:"button",onClick:fe,className:"add-sub-product",disabled:!((v==null?void 0:v.quantity)>49&&y._id!==null),children:p("add product")})]})]}),e.jsx("div",{className:"formInput",children:e.jsx($,{...t("note",{}),fullWidth:!0,id:"note",label:p("note"),inputProps:{style:{height:"50px"}},variant:"outlined",onChange:a=>{var c;h({...r,note:(c=a==null?void 0:a.target)==null?void 0:c.value})}})}),e.jsx("div",{className:"formInput buttons",children:e.jsx(re,{type:"submit",disabled:ve,className:"primary-button",children:p("save")})})]})}),j.length>0&&e.jsx(lt,{subProducts:j,setSubProducts:A})]})})})})};export{Ht as default};
