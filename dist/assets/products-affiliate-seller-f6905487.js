import{j as e,aU as O,t as p,T as b,ab as S,bo as v,a8 as y,aK as P,r as f}from"./index-335be6bc.js";import{S as T,u as z}from"./use-query-filter-82542176.js";import{F as D,u as w}from"./filter-button-group-69656d3d.js";import{S as E,P as I}from"./Star-b7589792.js";import{o as h}from"./statics-f6863f48.js";import{u as M}from"./use-categories-filter-4617dde9.js";import{C as B}from"./category-product-autocomplete-5f17f107.js";import{a as k,b as L,c as Q}from"./DialogContent-2da759e4.js";import{D as R}from"./DialogTitle-cffb5590.js";import{T as x}from"./TextField-e3426f14.js";import{A as N}from"./Autocomplete-7da48e1d.js";import{P as Y,g as G}from"./product-21193570.js";import{q as H}from"./functions-6046b92c.js";import{u as J}from"./useDispatch-5616ae48.js";import"./ButtonGroup-59079b0e.js";import"./useControlled-35363894.js";import"./useSlot-06d6b379.js";import"./categories-55af903f.js";import"./Paper-7bffdec0.js";import"./FormControl-0c7a5a9b.js";import"./isMuiElement-28855bcf.js";import"./List-429b0059.js";import"./Grow-32d2c9c3.js";import"./Portal-29f66c29.js";import"./Close-a8700400.js";import"./Popper-6a651f11.js";import"./bahrain-57f02bd3.js";import"./moment-fbc5633a.js";const K=({queryFilter:s,setQueryFilter:i,setFilterOpen:l,handleClear:a})=>{const t=()=>{i(r=>{const o={...r};return r.isFavorite?delete o.isFavorite:o.isFavorite=!0,{...o}})};return e.jsx("div",{className:"datatableTitle",children:e.jsxs("div",{className:"searchBar",children:[e.jsx(T,{queryFilter:s,setQueryFilter:i}),e.jsx(O,{onClick:t,sx:{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#F1F1F1",height:"40px",width:"40px",borderRadius:"50%","&:hover":{backgroundColor:"#D3D3D3"}},children:e.jsx(E,{fontSize:"large",sx:{color:s.isFavorite?"var(--color-main)":"#B3B3B3"}})}),e.jsx(D,{queryFilter:s,setFilterOpen:l,handleClear:a,countColorFilter:1})]})})};const U=({filterOpen:s=!1,setFilterOpen:i,queryFilter:l,setQueryFilter:a})=>{const{query:t,handleAutocompleteChange:r,handleInput:o,handleClear:u,handleFilter:c,setQuery:m}=w(l,a,i),{choosenCategories:d,categoriesList:g,handleCategoriesChange:A}=M(t,m);return e.jsxs(k,{open:s,onClose:()=>i(!1),sx:{height:"100%"},maxWidth:"md",children:[e.jsx(R,{className:"dialog-title",children:e.jsx("span",{className:" capitalize",children:p("products filter")})}),e.jsx(L,{className:"products-filter-container",children:e.jsx("div",{className:"filter-section",children:e.jsx("div",{className:"filter-product infos-filter ",children:e.jsxs("div",{className:"left-filter",children:[e.jsxs("div",{className:"filter-operation",children:[e.jsx(x,{sx:{flex:1},id:"commission",label:p("commission"),value:(t==null?void 0:t.commission)||"",type:"number",variant:"outlined",onChange:o}),e.jsx(N,{sx:{flex:1},id:"commissionOperation",options:h,value:h.find(n=>n.value===(t==null?void 0:t.commissionOperation))||null,onChange:(n,j)=>{r("commissionOperation",j)},getOptionLabel:n=>n.label,renderInput:n=>e.jsx(x,{...n,label:p("operation"),variant:"outlined"})})]}),e.jsxs("div",{className:"filter-operation",children:[e.jsx(x,{sx:{flex:1},id:"price",label:p("price"),value:(t==null?void 0:t.price)||"",type:"number",variant:"outlined",onChange:o}),e.jsx(N,{sx:{flex:1},id:"priceOperation",options:h,value:h.find(n=>n.value===(t==null?void 0:t.priceOperation))||null,onChange:(n,j)=>{r("priceOperation",j)},getOptionLabel:n=>n.label,renderInput:n=>e.jsx(x,{...n,label:p("operation"),variant:"outlined"})})]}),e.jsx("div",{className:"filter-country"}),e.jsx(B,{choosenCategories:d,categoriesList:g,handleCategoriesChange:A,label:"category"})]})})})}),e.jsxs(Q,{children:[e.jsx(b,{onClick:u,children:p("clear")}),e.jsx(b,{onClick:c,children:p("filter")})]})]})},W=({numberOfTotalProducts:s,numberOfCardsToShow:i,paginationModel:l,setPaginationModel:a,products:t,queryFilter:r,setQueryFilter:o})=>(r==null?void 0:r.isFavorite)&&(!t||t.list.length===0)?e.jsxs("div",{className:"noFavoritesMessage",style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",marginTop:"2rem"},children:[e.jsx(S,{variant:"h3",sx:{fontSize:"24px",color:"var(--color-main)"},children:"You don't have favorite products"}),e.jsx(S,{variant:"body1",style:{margin:"1rem 0",color:"var(--color-gray)"},children:"You should add products to favorites."}),e.jsx(b,{className:"primary-button",onClick:()=>{o(c=>{const m={...c};return delete m.isFavorite,{...m}})},children:"Show All Products"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-products",children:t==null?void 0:t.list.map(c=>e.jsx(Y,{info:c,type:"affiliate"},c.id))}),e.jsx(I,{numberOfTotalProducts:s,numberOfCardsToShow:i,paginationModel:l,setPaginationModel:a})]}),C=(s,i,l)=>{let a;l===v.cards?a=[50].includes(Number(s))?Number(s):50:a=[10,25,50].includes(Number(s))?Number(s):10;const t=Number.isInteger(Number(i))?Number(i):0;return{pageSize:a,page:t}},F=(s,i,l)=>{const a=[10,25,50];return Number.isInteger(Number(i))?l===v.cards&&Number(s)===50?!0:!!a.includes(Number(s)):!1},X=(s,i)=>{const a=J(),[t,r]=y(),o=P(d=>d.productAffiliateSeller.displayMode)||v.cards,[u,c]=f.useState(C(t.get("pageSize"),t.get("page"),o));f.useEffect(()=>{if(o===v.cards&&Number(t.get("pageSize")||0)!==50){const d={page:Math.floor(u.page*u.pageSize/50),pageSize:50};c(d),r(g=>({...Object.fromEntries(Array.from(g.entries())),...d}))}},[o]);const m=f.useRef(!0);return f.useEffect(()=>{m.current?m.current=!1:c(d=>({pageSize:d.pageSize,page:0}))},[JSON.stringify(s)]),f.useEffect(()=>{F(t.get("pageSize"),t.get("page"),o)||r(d=>({...Object.fromEntries(Array.from(d.entries())),...C(t.get("pageSize"),t.get("page"),o)}))},[t,r]),f.useEffect(()=>{(async()=>{try{F(t.get("pageSize"),t.get("page"),o)&&await i(H(Object.fromEntries(t.entries())),a)}catch{throw new Error("error fetching data")}})()},[t,a,r,i]),{paginationModel:u,setPaginationModel:c}},Ce=()=>{const i=P(m=>m.productAffiliateSeller.productsAffiliateSeller),[l,a]=f.useState(!1),{queryFilter:t,setQueryFilter:r}=z({isFavorite:!0}),{paginationModel:o,setPaginationModel:u}=X(t,G),c=f.useCallback(m=>{r({})},[]);return e.jsx("div",{className:"listProductAffiliate",children:e.jsx("div",{className:"listContainer",children:e.jsx("div",{className:"listTable",children:e.jsxs("div",{className:"products datatableProducts overflowPreventer",children:[e.jsx(K,{queryFilter:t,setQueryFilter:r,setFilterOpen:a,handleClear:c}),e.jsx(U,{filterOpen:l,setFilterOpen:a,queryFilter:t,setQueryFilter:r}),e.jsx(W,{paginationModel:o,setPaginationModel:u,products:i,numberOfCardsToShow:50,numberOfTotalProducts:i.totalItems,queryFilter:t,setQueryFilter:r})]})})})})};export{Ce as default};
