import{bl as y,b,bm as F,bn as C,f as D,j as i,bj as x,t as s,bk as u,a8 as S,r as g,ap as f,aj as A,T as j,aK as E}from"./index-335be6bc.js";import{F as T,u as z}from"./filter-button-group-69656d3d.js";import{D as O}from"./drop-down-order-type-c0d45b22.js";import{S as W,u as P}from"./use-query-filter-82542176.js";import{T as p}from"./Tooltip-0185c911.js";import{C as k}from"./CurrencyExchange-6fe0cf9c.js";import{g as v,q as I}from"./functions-6046b92c.js";import{i as N}from"./validator-9e88d0aa.js";import{u as R}from"./useDispatch-5616ae48.js";import{a as $,b as M,c as q}from"./DialogContent-2da759e4.js";import{D as B}from"./DialogTitle-cffb5590.js";import{A as K}from"./Autocomplete-7da48e1d.js";import{T as H}from"./TextField-e3426f14.js";import{D as L}from"./DataGrid-b5ad00e6.js";import"./ButtonGroup-59079b0e.js";import"./KeyboardArrowDown-7229c3ca.js";import"./MenuItem-ae06aebb.js";import"./List-429b0059.js";import"./listItemTextClasses-c15af42f.js";import"./useSlot-06d6b379.js";import"./Popper-6a651f11.js";import"./Grow-32d2c9c3.js";import"./Portal-29f66c29.js";import"./useControlled-35363894.js";import"./moment-fbc5633a.js";import"./Paper-7bffdec0.js";import"./Close-a8700400.js";import"./FormControl-0c7a5a9b.js";import"./isMuiElement-28855bcf.js";import"./Divider-88aee12a.js";import"./ClickAwayListener-9b9a333f.js";import"./ListItemText-666b43be.js";import"./Checkbox-863386b3.js";import"./SwitchBase-6ca860c4.js";import"./InputAdornment-345b342e.js";import"./TableCell-077dec01.js";import"./FormControlLabel-c815a521.js";import"./getThemeProps-e55d9c99.js";const U=async(e,r)=>{r(y());try{const t=await b.get(`/order-toop-drop/invoice-pagination?${e}`);return r(F(t.data)),t.data;return t.data}catch(t){r(C()),D(t,r)}},V=({queryFilter:e,setQueryFilter:r,setFilterOpen:t,handleClear:l})=>i.jsxs("div",{className:"searchBar",children:[i.jsx(W,{queryFilter:e,setQueryFilter:r}),i.jsx(O,{queryFilter:e,setQueryFilter:r,showAll:!0}),i.jsx(T,{queryFilter:e,setFilterOpen:t,handleClear:l,countColorFilter:1})]}),G=[{field:"id",headerName:"id",flex:1,minWidth:120,headerAlign:"center",align:"left",renderCell:e=>{var r,t;return i.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:5},className:"two-values",children:[(r=e.row)==null?void 0:r.id,((t=e.row)==null?void 0:t.isRevenueTaken)&&i.jsx(p,{title:"The order revenue has been added to your account",placement:"right",children:i.jsx(k,{style:{color:"var(--color-secondary)"},fontSize:"small"})})]})}},{field:"callCenterFee",headerName:"call center fees",flex:1,minWidth:135,headerAlign:"center",align:"center",renderCell:e=>{var r,t,l;return i.jsx("div",{className:"cellWithFee",children:i.jsx(p,{title:i.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:"16px"},children:(t=(r=e==null?void 0:e.row[x.callCenter])==null?void 0:r.fees)==null?void 0:t.map(o=>i.jsxs("span",{className:`${s(o.unit)}`,children:[s(o.name),": ",Number(o.value||0).toFixed(2)]}))}),children:i.jsx("span",{className:"dollar",children:Number(((l=e==null?void 0:e.row[x.callCenter])==null?void 0:l.value)||0).toFixed(2)})})})}},{field:"shippingFee",headerName:"shipping fee",flex:1,minWidth:113,headerAlign:"center",align:"center",renderCell:e=>{var r,t,l,o,c,a,m,d;return i.jsx("div",{className:"cellWithFee",children:e.row[x.domesticShipping]!==void 0?i.jsx(p,{title:i.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:"16px"},children:(t=(r=e==null?void 0:e.row[x.domesticShipping])==null?void 0:r.fees)==null?void 0:t.map(n=>i.jsxs("span",{className:`${s(n==null?void 0:n.unit)}`,children:[s(n.name),":"," ",(n==null?void 0:n.name)===u.cod||(n==null?void 0:n.name)===u.vat?(Number(n.value)*100).toFixed(2):Number(n.value).toFixed(2)]}))}),children:i.jsx("span",{className:"dollar",children:Number((l=e==null?void 0:e.row[x.domesticShipping])==null?void 0:l.value).toFixed(2)})}):e.row[x.internationalShippingKSA]!==void 0?i.jsx(p,{title:i.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:"16px"},children:(o=e==null?void 0:e.row[x.internationalShippingKSA])==null?void 0:o.fees.map(n=>i.jsxs("span",{className:`${s(n==null?void 0:n.unit)}`,children:[s(n.name),": ",Number(n==null?void 0:n.value)]}))}),children:i.jsx("span",{className:"dollar",children:(c=e==null?void 0:e.row[x.internationalShippingKSA])==null?void 0:c.value.toFixed(2)})}):(e==null?void 0:e.row[x.internationalShippingUAE])!==void 0?i.jsx(p,{title:i.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:"16px"},children:(m=(a=e==null?void 0:e.row[x.internationalShippingUAE])==null?void 0:a.fees)==null?void 0:m.map(n=>i.jsxs("span",{className:`${s(n.unit)}`,children:[s(n.name),": ",Number(n.value)]}))}),children:i.jsx("span",{className:"dollar",children:Number((d=e==null?void 0:e.row[x.internationalShippingUAE])==null?void 0:d.value).toFixed(2)})}):i.jsx("span",{className:"dollar",children:"0"})})}},{field:"cod",headerName:"cod",flex:1,minWidth:113,headerAlign:"center",align:"center",renderCell:e=>{var r,t,l,o,c,a;return i.jsx("div",{className:"cellWithFee",children:i.jsx(p,{title:i.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:"16px"},children:i.jsxs("span",{className:`${s((t=(r=e.row[u.cod])==null?void 0:r.fees[0])==null?void 0:t.unit)}`,children:[s(((o=(l=e.row[u.cod])==null?void 0:l.fees[0])==null?void 0:o.name)||"COD fee"),":"," ",Number(((a=(c=e.row[u.cod])==null?void 0:c.fees[0])==null?void 0:a.value)||0).toFixed(2)]})}),children:i.jsx("span",{className:"dollar",children:e.row[u.cod]?Number(e.row[u.cod].value).toFixed(2):0})})})}},{field:"vat",headerName:"vat",flex:1,minWidth:113,headerAlign:"center",align:"center",renderCell:e=>{var r,t,l,o,c,a;return i.jsx("div",{className:"cellWithFee",children:i.jsx(p,{title:i.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:"16px"},children:i.jsxs("span",{className:`${s((t=(r=e.row[u.vat])==null?void 0:r.fees[0])==null?void 0:t.unit)}`,children:[s((o=(l=e.row[u.vat])==null?void 0:l.fees[0])==null?void 0:o.name)||"VAT fee",":"," ",Number(((a=(c=e.row[u.vat])==null?void 0:c.fees[0])==null?void 0:a.value)||0).toFixed(2)]})}),children:i.jsx("span",{className:"dollar",children:e.row[u.vat]?Number(e.row[u.vat].value).toFixed(2):0})})})}},{field:"totalFee",headerName:"total fees",flex:1,minWidth:113,headerAlign:"center",align:"center",renderCell:e=>{var r,t;return i.jsx("span",{className:"dollar",children:((t=(r=e==null?void 0:e.row)==null?void 0:r.totalFee)==null?void 0:t.toFixed(2))||0})}},{field:"wills",headerName:"revenue",flex:1,minWidth:113,headerAlign:"center",align:"center",renderCell:e=>{var r,t;return i.jsx("span",{className:"dollar",children:((t=(r=e==null?void 0:e.row)==null?void 0:r.wills)==null?void 0:t.toFixed(2))||0})}}],Q=(e,r)=>{const t=R(),[l,o]=S(),[c,a]=g.useState(v(l.get("pageSize"),l.get("page"))),m=g.useRef(!0);return g.useEffect(()=>{m.current?m.current=!1:a(d=>({pageSize:d.pageSize,page:0}))},[JSON.stringify(e)]),g.useEffect(()=>{N(l.get("pageSize"),l.get("page"))||o(d=>({...Object.fromEntries(Array.from(d.entries())),...v(l.get("pageSize"),l.get("page"))}),{replace:!0})},[l,o]),g.useEffect(()=>{(async()=>{try{if(N(l.get("pageSize"),l.get("page"))){const n=await r(I(Object.fromEntries(l.entries())),t);!l.get("type")&&n.type&&o(h=>({...Object.fromEntries(Array.from(h.entries())),type:n.type}),{replace:!0})}}catch{throw new Error("error fetching data")}})()},[l,t,o,r]),{paginationModel:c,setPaginationModel:a}};const _=({filterOpen:e,setFilterOpen:r,queryFilter:t,setQueryFilter:l})=>{const{query:o,handleAutocompleteChange:c,handleClear:a,handleFilter:m}=z(t,l,r);return i.jsxs($,{open:e,onClose:()=>r(!1),sx:{height:"100%"},maxWidth:"md",children:[i.jsx(B,{className:"dialog-title",children:i.jsx("span",{className:" capitalize",children:s("invoices filter")})}),i.jsx(M,{className:"products-filter-container",children:i.jsx(f,{p:1,className:"filter-section",children:i.jsx(f,{className:"filter-product infos-filter ",children:i.jsx(f,{className:"left-filter",children:i.jsx(f,{className:"filter-status",children:i.jsx(K,{sx:{flex:1},id:"currentStatus",options:Object.values(A),value:o.currentStatus||null,onChange:(d,n)=>{c("currentStatus",n)},getOptionLabel:d=>s(d),renderInput:d=>i.jsx(H,{...d,label:s("status"),variant:"outlined"})})})})})})}),i.jsxs(q,{children:[i.jsx(j,{onClick:()=>{a({})},children:s("clear")}),i.jsx(j,{onClick:m,children:s("filter")})]})]})},Pe=()=>{const[e,r]=S(),t=E(h=>h.invoiceToopDrop.invoices),[l,o]=g.useState(!1),{queryFilter:c,setQueryFilter:a}=P(),{paginationModel:m,setPaginationModel:d}=Q(c,U),n=g.useCallback(()=>{a({})},[]);return i.jsx("div",{className:"listData",children:i.jsx("div",{className:"listContainer",children:i.jsx("div",{className:"listTable",children:i.jsxs("div",{className:"invoiceTable overflowPreventer",children:[i.jsx(_,{filterOpen:l,setFilterOpen:o,queryFilter:c,setQueryFilter:a}),i.jsx(V,{queryFilter:c,setQueryFilter:a,setFilterOpen:o,handleClear:n}),i.jsx(L,{autoHeight:!0,rows:t.list?t.list:[],columns:G.map(h=>({...h,headerName:s(h.headerName)})),getRowId:h=>h._id,pageSizeOptions:[10,25,50],checkboxSelection:!0,disableRowSelectionOnClick:!0,pagination:!0,rowCount:t.totalItems,paginationModel:m,paginationMode:"server",onPaginationModelChange:h=>{d(h),r(w=>({...Object.fromEntries(Array.from(w.entries())),...h}))}})]})})})})};export{Pe as default};
